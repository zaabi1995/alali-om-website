import{r as i,m as g,j as t}from"./index-DsxgoXaO.js";import{o as y}from"./omrFormat-C3L8_xkq.js";import{b as j,a as b,C as S,h as w,T as s,O as v}from"./ErpApp-3NZWEkOD.js";import{O as C,g as I,aV as O,aN as T,aM as c,aL as d,aB as z,aY as A}from"./IdurarOs-BmcscLXI.js";import{C as p}from"./index-D7xQuJHc.js";import{F as D}from"./Table-B_wqoxqg.js";import"./Skeleton-DKI-OLNZ.js";import"./index-HED-hjAe.js";import"./PlusOutlined-C2sCGP9k.js";var R={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M869 487.8L491.2 159.9c-2.9-2.5-6.6-3.9-10.5-3.9h-88.5c-7.4 0-10.8 9.2-5.2 14l350.2 304H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h585.1L386.9 854c-5.6 4.9-2.2 14 5.2 14h91.5c1.9 0 3.8-.7 5.2-2L869 536.2a32.07 32.07 0 000-48.4z"}}]},name:"arrow-right",theme:"outlined"},k=function(r,l){return i.createElement(C,I({},r,{ref:l,icon:R}))};const B=i.forwardRef(k),{Title:Y,Text:H}=A;function E(){return{Authorization:`Bearer ${((JSON.parse(localStorage.getItem("auth"))||{}).current||{}).token}`}}function u(o){return y(o)}function F({color:o="#4CB480",size:r=28}){return t.jsx("div",{style:{width:r,height:r,borderRadius:"50%",border:`2px solid ${o}`,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:t.jsx(v,{size:r*.42,color:o})})}const h=[{key:"rfqs",label:"Open RFQs",icon:t.jsx(j,{}),color:"#1890ff",desc:"Active procurement requests"},{key:"quotes",label:"Open Quotes",icon:t.jsx(b,{}),color:"#fa8c16",desc:"Quotations pending response"},{key:"invoices",label:"Invoices Due",icon:t.jsx(S,{}),color:"#e53e3e",desc:"Invoices awaiting payment"},{key:"paid",label:"Paid (YTD)",icon:t.jsx(F,{}),color:"#4CB480",desc:"Total payments received"}];function U(){const o=g(),[r,l]=i.useState(null),[m,x]=i.useState(!0);if(i.useEffect(()=>{fetch(O+"reports/pipeline",{headers:E()}).then(e=>e.json()).then(e=>{e.success&&l(e.result)}).finally(()=>x(!1))},[]),m)return t.jsx("div",{style:{textAlign:"center",padding:60},children:t.jsx(T,{size:"large"})});const a=(r==null?void 0:r.stages)||{},f=[{title:"Invoice",dataIndex:"number",width:90,render:(e,n)=>t.jsxs("a",{onClick:()=>o(`/invoice/read/${n._id}`),style:{fontWeight:700,color:"#034D57"},children:["INV-",e,"/",n.year]})},{title:"Client",dataIndex:["client","name"],ellipsis:!0},{title:"Date",dataIndex:"date",width:110,render:e=>w(e).format("DD MMM YYYY")},{title:"Amount",dataIndex:"total",align:"right",render:e=>t.jsx("strong",{children:u(e)})},{title:"Status",dataIndex:"status",width:100,render:e=>{const n={draft:"default",pending:"blue",sent:"cyan",received:"orange",cancelled:"red",refund:"purple"};return t.jsx(s,{color:n[e]||"default",children:e==null?void 0:e.toUpperCase()})}},{title:"Payment",dataIndex:"paymentStatus",width:100,render:e=>{const n={unpaid:"red","partially paid":"orange",paid:"green"};return e?t.jsx(s,{color:n[e]||"default",children:e==null?void 0:e.toUpperCase()}):"—"}}];return t.jsxs("div",{style:{padding:"24px"},children:[t.jsx(Y,{level:4,style:{color:"#034D57",marginBottom:20},children:"Deal Pipeline"}),t.jsx(c,{gutter:16,style:{marginBottom:28},children:h.map((e,n)=>t.jsx(d,{xs:12,md:6,children:t.jsxs(p,{size:"small",style:{borderTop:`4px solid ${e.color}`,textAlign:"center",position:"relative"},bodyStyle:{padding:"16px 12px"},children:[t.jsx("div",{style:{fontSize:28,color:e.color,marginBottom:6},children:e.icon}),t.jsx("div",{style:{fontSize:28,fontWeight:800,color:"#1a1a1a",lineHeight:1},children:e.key==="paid"?t.jsx("span",{style:{fontSize:16},children:u(a[e.key])}):a[e.key]??"—"}),t.jsx("div",{style:{fontSize:12,fontWeight:600,color:"#034D57",marginTop:4},children:e.label}),t.jsx("div",{style:{fontSize:10,color:"#aaa",marginTop:2},children:e.desc}),n<h.length-1&&t.jsx("div",{style:{position:"absolute",right:-14,top:"50%",transform:"translateY(-50%)",zIndex:1},children:t.jsx(B,{style:{color:"#ccc",fontSize:18}})})]})},e.key))}),t.jsx(c,{gutter:12,style:{marginBottom:20},children:[{label:"View Open RFQs",color:"#1890ff",path:"/rfq?status=new,in_progress"},{label:"View Open Quotes",color:"#fa8c16",path:"/quote"},{label:"Outstanding Invoices",color:"#e53e3e",path:"/invoice"},{label:"Aged Receivables",color:"#034D57",path:"/reports"}].map(e=>t.jsx(d,{xs:12,md:6,children:t.jsx(z,{block:!0,onClick:()=>o(e.path),style:{borderColor:e.color,color:e.color,height:40},children:e.label})},e.label))}),t.jsx(p,{title:"Recent Deals",size:"small",children:t.jsx(D,{columns:f,dataSource:(r==null?void 0:r.recentDeals)||[],rowKey:"_id",size:"small",pagination:{pageSize:10},locale:{emptyText:"No invoices yet"}})})]})}export{U as default};
