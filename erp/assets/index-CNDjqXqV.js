import{m as v,r as n,j as t}from"./index-BdDb7ySv.js";import{o as z}from"./omrFormat-DmOopsSG.js";import{aA as y,aB as u,aD as T,ai as j,ar as _,ay as B}from"./IdurarOs-dHE_gtdC.js";import{C as w}from"./index-BXuZsnPN.js";import{S as C}from"./index-DegQHdRQ.js";import{F as A}from"./Table-BFtvumgA.js";import{T as F}from"./index-Dc9uktoS.js";import{R as O}from"./ReloadOutlined-CUQB555Z.js";import"./ErpApp-DCg0EmsZ.js";import"./Skeleton-DcxcBGAO.js";import"./index-DG8k-4gF.js";import"./PlusOutlined-DOWtOXxu.js";import"./pickAttrs-Bwg9skD5.js";import"./DownOutlined-DqKo3zi1.js";import"./useClosable-BZXF0ji5.js";function D(){var l,o;try{const d=(o=(l=JSON.parse(localStorage.getItem("auth")||"{}"))==null?void 0:l.current)==null?void 0:o.token;return d?{Authorization:`Bearer ${d}`}:{}}catch{return{}}}const{Title:L,Text:g}=_,{Option:i}=C;function re(){const l=v(),[o,d]=n.useState([]),[R,x]=n.useState(!0),[c,I]=n.useState({current:1,pageSize:30,total:0}),[h,p]=n.useState(""),[f,P]=n.useState("all"),s=async(e=1,r=h,a=f)=>{x(!0);const N=new URLSearchParams({page:e,items:30,...r&&{fields:"partNumber,nsn,description",q:r},...a!=="all"&&{filter:"status",equal:a}}),m=await(await fetch(B+`part/list?${N}`,{headers:D()})).json();m.success!==!1&&(d(m.result||[]),I(q=>{var S;return{...q,current:e,total:((S=m.pagination)==null?void 0:S.count)||0}})),x(!1)};n.useEffect(()=>{s()},[]);const b={done:"success",pending:"default",researching:"processing",no_results:"warning"},k=[{title:"Part Number",dataIndex:"partNumber",key:"partNumber",width:150,render:e=>t.jsx(g,{strong:!0,style:{color:"#034D57"},children:e||"—"})},{title:"NSN",dataIndex:"nsn",key:"nsn",width:140,render:e=>e?t.jsx(g,{code:!0,style:{fontSize:12},children:e}):"—"},{title:"Description",dataIndex:"description",key:"description",ellipsis:!0,render:e=>e||"—"},{title:"Qty",dataIndex:"quantity",key:"quantity",width:60,align:"center"},{title:"Research",dataIndex:"status",key:"status",width:110,render:e=>t.jsx(F,{color:b[e]||"default",style:{fontSize:11},children:e})},{title:"Sell Price",dataIndex:"unitSellPrice",key:"unitSellPrice",width:110,align:"right",render:(e,r)=>{const a=e||r.unitCostOmr;return a?t.jsx(g,{strong:!0,children:z(a)}):"—"}},{title:"RFQ",dataIndex:["rfq","rfqNumber"],key:"rfq",width:130,render:(e,r)=>{var a;return r.rfq?t.jsx(j,{type:"link",size:"small",style:{padding:0,color:"#034D57",fontSize:12},onClick:()=>l(`/rfq/${r.rfq._id||r.rfq}`),children:e||((a=r.rfq)==null?void 0:a.subject)||"→ View RFQ"}):"—"}}];return t.jsxs("div",{style:{paddingBottom:24},children:[t.jsx(y,{justify:"space-between",align:"middle",style:{marginBottom:16},children:t.jsx(u,{children:t.jsxs(L,{level:4,style:{margin:0,color:"#034D57"},children:["Parts Catalog — ",c.total.toLocaleString()]})})}),t.jsx(w,{style:{marginBottom:16,borderRadius:8},bodyStyle:{padding:"12px 16px"},children:t.jsxs(y,{gutter:[8,8],align:"middle",children:[t.jsx(u,{xs:24,sm:12,md:8,children:t.jsx(T.Search,{placeholder:"Search part #, NSN, description...",value:h,onChange:e=>p(e.target.value),onSearch:e=>{p(e),s(1,e)},allowClear:!0,onClear:()=>{p(""),s(1,"")}})}),t.jsx(u,{xs:12,sm:6,md:4,children:t.jsxs(C,{style:{width:"100%"},value:f,onChange:e=>{P(e),s(1,h,e)},children:[t.jsx(i,{value:"all",children:"All Status"}),t.jsx(i,{value:"done",children:"Researched"}),t.jsx(i,{value:"pending",children:"Pending"}),t.jsx(i,{value:"no_results",children:"No Results"}),t.jsx(i,{value:"researching",children:"In Progress"})]})}),t.jsx(u,{children:t.jsx(j,{icon:t.jsx(O,{}),onClick:()=>s(),children:"Refresh"})})]})}),t.jsx(w,{style:{borderRadius:8},bodyStyle:{padding:0},children:t.jsx("div",{style:{overflowX:"auto"},children:t.jsx(A,{dataSource:o,columns:k,rowKey:"_id",loading:R,size:"small",pagination:{current:c.current,pageSize:c.pageSize,total:c.total,showSizeChanger:!1,showTotal:e=>`${e} parts`,onChange:e=>s(e)}})})})]})}export{re as default};
