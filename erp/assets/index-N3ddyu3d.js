import{m as D,o as S,r as u,j as e}from"./index-DGBU46UJ.js";import{d as h}from"./dayjs.min-8Z1s2ZZV.js";import{ay as p,ai as c,aw as F,aA as I,aB as s,ar as C}from"./IdurarOs-CJ9ViAhm.js";import{j}from"./ErpApp-CYUZ8TN2.js";import{T as B}from"./index-BJe3uNvq.js";import{P as $}from"./index-4j7roaEt.js";import{C as l}from"./index-CjcNLPXh.js";import{S as n}from"./index-jUM5zKUs.js";import{D as a}from"./index-iOI7SQQY.js";import{F as o}from"./Table-D6trtlAr.js";import{s as z}from"./index-C-NUezbm.js";import{A as O}from"./ArrowLeftOutlined-B33LkA-B.js";import{D as R}from"./DeleteOutlined-CPNGvea9.js";import"./useClosable-CO9qeB94.js";import"./ActionButton-CXYEvTjl.js";import"./Skeleton-CtKtAXNJ.js";import"./index-CjgSDB-1.js";import"./PlusOutlined-WiqW7VqH.js";import"./pickAttrs-fHa9THfw.js";import"./index-DbQUCUwL.js";import"./DownOutlined-CLg65-LR.js";const{Title:T}=C;function f(){return{Authorization:`Bearer ${localStorage.getItem("x-auth-token")}`}}const E={draft:"default",received:"blue",approved:"cyan",partially_paid:"orange",paid:"green",overdue:"red",cancelled:"default"};function te(){var m,x;const d=D(),{id:i}=S(),[t,y]=u.useState(null);u.useEffect(()=>{fetch(p+`vendorbill/read/${i}`,{headers:f()}).then(r=>r.json()).then(r=>{r.success&&y(r.result)}).catch(()=>{})},[i]);const g=async()=>{await fetch(p+`vendorbill/delete/${i}`,{method:"DELETE",headers:f()}),z.success("Deleted"),d("/vendor-bill")};if(!t)return e.jsx("div",{style:{padding:24},children:"Loading…"});const b=[{title:"Description",dataIndex:"description"},{title:"Qty",dataIndex:"quantity",width:80,align:"right"},{title:"Unit Price",dataIndex:"unitPrice",align:"right",render:r=>`${parseFloat(r||0).toFixed(4)} ${t.currency}`},{title:"Total",dataIndex:"total",align:"right",render:r=>e.jsxs("b",{children:[parseFloat(r||0).toFixed(3)," ",t.currency]})}];return e.jsxs("div",{style:{padding:24,maxWidth:900},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsxs(j,{children:[e.jsx(c,{icon:e.jsx(O,{}),onClick:()=>d("/vendor-bill")}),e.jsxs(T,{level:4,style:{margin:0,color:"#034D57"},children:["BILL-",t.number,"/",t.year]}),e.jsx(B,{color:E[t.status],children:(m=t.status)==null?void 0:m.replace(/_/g," ").toUpperCase()})]}),e.jsxs(j,{children:[e.jsx(c,{icon:e.jsx(F,{}),onClick:()=>d(`/vendor-bill/edit/${i}`),children:"Edit"}),e.jsx($,{title:"Delete this bill?",onConfirm:g,children:e.jsx(c,{danger:!0,icon:e.jsx(R,{}),children:"Delete"})})]})]}),e.jsxs(I,{gutter:12,style:{marginBottom:16},children:[e.jsx(s,{xs:12,sm:6,children:e.jsx(l,{size:"small",children:e.jsx(n,{title:"Total",value:`${parseFloat(t.total||0).toFixed(3)} ${t.currency}`,valueStyle:{fontSize:14,color:"#034D57"}})})}),e.jsx(s,{xs:12,sm:6,children:e.jsx(l,{size:"small",children:e.jsx(n,{title:"Paid",value:`${parseFloat(t.amountPaid||0).toFixed(3)} ${t.currency}`,valueStyle:{fontSize:14,color:"#4CB480"}})})}),e.jsx(s,{xs:12,sm:6,children:e.jsx(l,{size:"small",children:e.jsx(n,{title:"Balance Due",value:`${parseFloat(t.balanceDue||0).toFixed(3)} ${t.currency}`,valueStyle:{fontSize:14,color:t.balanceDue>0?"#e53e3e":"#4CB480",fontWeight:700}})})}),e.jsx(s,{xs:12,sm:6,children:e.jsx(l,{size:"small",children:e.jsx(n,{title:"OMR Equivalent",value:parseFloat(t.totalOMR||0).toFixed(3),suffix:"OMR",valueStyle:{fontSize:14}})})})]}),e.jsx(l,{title:"Bill Details",size:"small",style:{marginBottom:16},children:e.jsxs(a,{column:{xs:1,sm:2},bordered:!0,size:"small",children:[e.jsx(a.Item,{label:"Vendor",children:e.jsx("b",{children:((x=t.vendor)==null?void 0:x.companyName)||"—"})}),e.jsx(a.Item,{label:"Vendor Invoice #",children:t.vendorRef||"—"}),e.jsx(a.Item,{label:"Bill Date",children:t.date?h(t.date).format("DD MMM YYYY"):"—"}),e.jsx(a.Item,{label:"Due Date",children:t.dueDate?h(t.dueDate).format("DD MMM YYYY"):"—"}),e.jsxs(a.Item,{label:"Currency",children:[t.currency," (rate: ",t.exchangeRate||1,")"]}),e.jsx(a.Item,{label:"Linked PO",children:t.purchaseOrder?`PO-${t.purchaseOrder.number}/${t.purchaseOrder.year}`:"—"}),e.jsxs(a.Item,{label:"Tax",children:[parseFloat(t.taxAmount||0).toFixed(3)," ",t.currency]}),t.notes&&e.jsx(a.Item,{label:"Notes",span:2,children:t.notes})]})}),e.jsx(l,{title:"Line Items",size:"small",children:e.jsx(o,{columns:b,dataSource:t.items||[],rowKey:(r,v)=>v,pagination:!1,size:"small",summary:()=>e.jsxs(o.Summary.Row,{children:[e.jsx(o.Summary.Cell,{index:0,colSpan:3,align:"right",children:e.jsx("b",{children:"Total"})}),e.jsx(o.Summary.Cell,{index:1,align:"right",children:e.jsxs("b",{style:{color:"#034D57"},children:[parseFloat(t.total||0).toFixed(3)," ",t.currency]})})]})})})]})}export{te as default};
