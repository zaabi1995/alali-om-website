import{r as i,j as e}from"./index-D5UekElC.js";import{o as U}from"./omrFormat-BiSEXmPi.js";import{d as $}from"./dayjs.min-Cc9SuVrv.js";import{aG as l,ai as S,aA as C,aB as a,aD as d,ar as G,ay as p,aw as J}from"./IdurarOs-Czf_9sCK.js";import{C as u}from"./index-DYNK0NBM.js";import{S as x}from"./index-DC-0h5FA.js";import{F as V}from"./Table-DllBtUC2.js";import{M as q}from"./index-gsiCY3FC.js";import{S as g}from"./index-B08isBVp.js";import{D as K}from"./index-Br3td9TI.js";import{T as W}from"./index-DdtlyhfV.js";import{s as h}from"./index-DQ2R1AC0.js";import{T as E}from"./index-C32fgKEF.js";import{T as Q,l as X}from"./ErpApp-BzOb2em0.js";import{P as Y}from"./index-G8Gvhj4N.js";import{P as Z}from"./PlusOutlined-cr0dcF6Y.js";import{D as ee}from"./DeleteOutlined-CNhDXZCd.js";import"./Skeleton-02t78DoW.js";import"./index-7O4MHiK_.js";import"./pickAttrs-BSfxLktl.js";import"./DownOutlined-BhJP4mMa.js";import"./ActionButton-CPWsPWif.js";import"./useClosable-B1cYkIyO.js";import"./fade-CxBm_vTE.js";import"./ClockCircleOutlined-BdfmQpJ5.js";const{Title:te,Text:w}=G;function j(){return{Authorization:`Bearer ${localStorage.getItem("x-auth-token")}`}}function se(){return{...j(),"Content-Type":"application/json"}}const ae={General:"default",Sales:"blue",Finance:"green",Procurement:"gold",Operations:"purple",Admin:"cyan",IT:"orange",HR:"pink"},le={active:"success",inactive:"default",on_leave:"warning"};function Oe(){var I,T;const[P,O]=i.useState([]),[o,A]=i.useState(null),[z,v]=i.useState(!1),[F,c]=i.useState(!1),[r,b]=i.useState(null),[_,D]=i.useState(!1),[m]=l.useForm(),y=async()=>{v(!0);const[t,s]=await Promise.all([fetch(p+"employee/list?items=100",{headers:j()}).then(n=>n.json()).catch(()=>({})),fetch(p+"employee/stats",{headers:j()}).then(n=>n.json()).catch(()=>({}))]);t.success&&O(t.result||[]),s.success&&A(s.result),v(!1)};i.useEffect(()=>{y()},[]);const k=()=>{b(null),m.resetFields(),c(!0)},B=t=>{b(t),m.setFieldsValue({...t,joinDate:t.joinDate?$(t.joinDate):null}),c(!0)},L=async()=>{var s;let t;try{t=await m.validateFields()}catch{return}t.joinDate&&(t.joinDate=t.joinDate.toISOString()),D(!0);try{const n=r?`employee/update/${r._id}`:"employee/create",M=r?"PATCH":"POST",f=await fetch(p+n,{method:M,headers:se(),body:JSON.stringify(t)}).then(N=>N.json());f.success?(h.success(r?"Updated":`Created: ${(s=f.result)==null?void 0:s.employeeId}`),c(!1),y()):h.error(f.message||"Failed")}finally{D(!1)}},R=async t=>{(await fetch(p+`employee/delete/${t}`,{method:"DELETE",headers:j()}).then(n=>n.json()).catch(()=>({}))).success?(h.success("Deleted"),y()):h.error("Failed")},H=[{title:"ID",dataIndex:"employeeId",width:90,render:t=>e.jsx(w,{code:!0,style:{fontSize:12},children:t})},{title:"Name",dataIndex:"name",render:(t,s)=>e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600},children:t}),s.position&&e.jsx(w,{type:"secondary",style:{fontSize:11},children:s.position})]})},{title:"Department",dataIndex:"department",render:t=>e.jsx(E,{color:ae[t]||"default",children:t})},{title:"Contact",render:(t,s)=>e.jsxs("div",{style:{fontSize:11},children:[s.email&&e.jsx("div",{children:s.email}),s.phone&&e.jsx("div",{style:{color:"#888"},children:s.phone})]})},{title:"Salary",dataIndex:"salary",align:"right",render:(t,s)=>t?U(t):"â€”"},{title:"Status",dataIndex:"status",render:t=>e.jsx(E,{color:le[t],children:t==null?void 0:t.replace("_"," ").toUpperCase()})},{title:"",key:"actions",width:80,render:(t,s)=>e.jsxs(X,{size:4,children:[e.jsx(S,{size:"small",icon:e.jsx(J,{}),onClick:()=>B(s)}),e.jsx(Y,{title:"Delete employee?",onConfirm:()=>R(s._id),children:e.jsx(S,{size:"small",danger:!0,icon:e.jsx(ee,{})})})]})}];return e.jsxs("div",{style:{padding:24},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsx(te,{level:4,style:{margin:0,color:"#034D57"},children:"Employees"}),e.jsx(S,{type:"primary",icon:e.jsx(Z,{}),onClick:k,style:{background:"#034D57",borderColor:"#034D57"},children:"Add Employee"})]}),o&&e.jsxs(C,{gutter:[12,12],style:{marginBottom:16},children:[e.jsx(a,{xs:12,sm:6,children:e.jsx(u,{size:"small",children:e.jsx(x,{title:"Total",value:o.total,prefix:e.jsx(Q,{})})})}),e.jsx(a,{xs:12,sm:6,children:e.jsx(u,{size:"small",children:e.jsx(x,{title:"Active",value:o.active,valueStyle:{color:"#4CB480"}})})}),e.jsx(a,{xs:12,sm:6,children:e.jsx(u,{size:"small",children:e.jsx(x,{title:"Present Today",value:((I=o.today)==null?void 0:I.present)||0,valueStyle:{color:"#034D57"}})})}),e.jsx(a,{xs:12,sm:6,children:e.jsx(u,{size:"small",children:e.jsx(x,{title:"Absent Today",value:((T=o.today)==null?void 0:T.absent)||0,valueStyle:{color:"#e53e3e"}})})})]}),e.jsx(V,{columns:H,dataSource:P,rowKey:"_id",loading:z,size:"small",pagination:{pageSize:20}}),e.jsx(q,{title:r?"Edit Employee":"Add Employee",open:F,onCancel:()=>c(!1),onOk:L,okText:"Save",confirmLoading:_,okButtonProps:{style:{background:"#034D57",borderColor:"#034D57"}},width:600,children:e.jsx(l,{form:m,layout:"vertical",style:{marginTop:12},children:e.jsxs(C,{gutter:12,children:[e.jsx(a,{span:14,children:e.jsx(l.Item,{name:"name",label:"Full Name",rules:[{required:!0}],children:e.jsx(d,{})})}),e.jsx(a,{span:10,children:e.jsx(l.Item,{name:"department",label:"Department",children:e.jsx(g,{options:["General","Sales","Finance","Procurement","Operations","Admin","IT","HR"].map(t=>({value:t,label:t})),allowClear:!0})})}),e.jsx(a,{span:12,children:e.jsx(l.Item,{name:"position",label:"Position",children:e.jsx(d,{})})}),e.jsx(a,{span:12,children:e.jsx(l.Item,{name:"email",label:"Email",children:e.jsx(d,{})})}),e.jsx(a,{span:12,children:e.jsx(l.Item,{name:"phone",label:"Phone",children:e.jsx(d,{})})}),e.jsx(a,{span:12,children:e.jsx(l.Item,{name:"joinDate",label:"Join Date",children:e.jsx(K,{style:{width:"100%"}})})}),e.jsx(a,{span:8,children:e.jsx(l.Item,{name:"salary",label:"Salary",children:e.jsx(W,{style:{width:"100%"},min:0,precision:3})})}),e.jsx(a,{span:8,children:e.jsx(l.Item,{name:"salaryType",label:"Type",initialValue:"monthly",children:e.jsx(g,{options:[{value:"monthly",label:"Monthly"},{value:"daily",label:"Daily"},{value:"hourly",label:"Hourly"}]})})}),e.jsx(a,{span:8,children:e.jsx(l.Item,{name:"status",label:"Status",initialValue:"active",children:e.jsx(g,{options:[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"on_leave",label:"On Leave"}]})})}),e.jsx(a,{span:24,children:e.jsx(l.Item,{name:"notes",label:"Notes",children:e.jsx(d.TextArea,{rows:2})})})]})})})]})}export{Oe as default};
