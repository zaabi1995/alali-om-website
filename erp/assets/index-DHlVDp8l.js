import{r,j as e}from"./index-CyT0g67B.js";import{C as n}from"./index-BZVWF8RY.js";import{bj as z,al as A,ai as o,aA as I,aB as c,ar as T,aw as O}from"./IdurarOs-CoqKtLRd.js";import{S as x}from"./index-D6yWtsXD.js";import{T as m}from"./index-xZM8wvuw.js";import{F as B}from"./Table-CMJN-8Gn.js";import{M as D}from"./index-CXhEjtWF.js";import{E as h}from"./ExportOutlined-DCkAD8iB.js";import{C as f}from"./CheckCircleOutlined-BohFqxZ-.js";import"./Skeleton-Bj6nBjWH.js";import"./index-OrgXV5Bf.js";import"./ErpApp-n-sDWNhY.js";import"./PlusOutlined-CsTGChi8.js";import"./pickAttrs-CO3lP972.js";import"./useClosable-D0kOyM-I.js";import"./index-C33Svftv.js";import"./DownOutlined-C1w3tzOL.js";import"./ActionButton-CZ1WJjCn.js";import"./fade-Cap0Kps1.js";const{Title:y,Text:j}=T,S="https://alali.om/email-signature",_=["ali.ghalib@alali.om","ali.alzaabi@alali.om"];function L(){var i;try{const l=JSON.parse(localStorage.getItem("auth")||"{}");return _.includes(((i=l==null?void 0:l.current)==null?void 0:i.email)||"")}catch{return!1}}function te(){const[i,l]=r.useState([]),[u,s]=r.useState(null),[v,b]=r.useState(""),[w,p]=r.useState(!1),C=["ali.ghalib@alali.om","ali.alzaabi@alali.om","milo@alali.om","munawar@alali.om","irfan@alali.om","salim@alali.om","atul@alali.om","aman@alali.om","amanali@alali.om","info@alali.om"],E=async()=>{p(!0);const t=await Promise.all(C.map(async a=>{try{const g=await fetch(`https://alali.om/email-signature/api/signature/${a}`).then(k=>k.json()).catch(()=>({}));return{email:a,found:!!g.found,html:g.html||""}}catch{return{email:a,found:!1,html:""}}}));l(t),p(!1)};if(r.useEffect(()=>{E()},[]),!L())return e.jsx("div",{style:{padding:48,textAlign:"center"},children:e.jsxs(n,{style:{maxWidth:400,margin:"0 auto"},children:[e.jsx(z,{style:{fontSize:48,color:"#ccc",marginBottom:16}}),e.jsx(y,{level:4,children:"Access Restricted"}),e.jsx(j,{type:"secondary",children:"Email Signature Manager is available to administrators only."})]})});const M=[{title:"Email",dataIndex:"email",render:t=>e.jsx(j,{code:!0,style:{fontSize:12},children:t})},{title:"Status",dataIndex:"found",align:"center",render:t=>t?e.jsx(m,{color:"success",icon:e.jsx(f,{}),children:"Active"}):e.jsx(m,{color:"default",children:"No Signature"})},{title:"",align:"right",width:100,render:(t,a)=>a.found&&e.jsx(o,{size:"small",icon:e.jsx(O,{}),onClick:()=>{s(a.html),b(a.email)},children:"Preview"})}],d=i.filter(t=>t.found).length;return e.jsxs("div",{style:{padding:24},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[e.jsx(A,{style:{fontSize:22,color:"#034D57"}}),e.jsx(y,{level:4,style:{margin:0,color:"#034D57"},children:"Email Signature Manager"})]}),e.jsx(o,{type:"primary",icon:e.jsx(h,{}),size:"large",onClick:()=>window.open(S,"_blank"),style:{background:"#034D57",borderColor:"#034D57"},children:"Open Manager"})]}),e.jsxs(I,{gutter:12,style:{marginBottom:20},children:[e.jsx(c,{span:8,children:e.jsx(n,{size:"small",bodyStyle:{padding:"12px 16px"},children:e.jsx(x,{title:"Active Signatures",value:d,valueStyle:{color:"#4CB480"},suffix:`/ ${i.length}`})})}),e.jsx(c,{span:8,children:e.jsx(n,{size:"small",bodyStyle:{padding:"12px 16px"},children:e.jsx(x,{title:"No Signature",value:i.length-d,valueStyle:{color:d<i.length?"#e53e3e":"#888"}})})}),e.jsx(c,{span:8,children:e.jsxs(n,{size:"small",bodyStyle:{padding:"12px 16px"},children:[e.jsx("div",{style:{fontSize:11,color:"#888",marginBottom:4},children:"Filter Status"}),e.jsx(m,{color:"success",icon:e.jsx(f,{}),style:{fontSize:12},children:"Running on port 10024"})]})})]}),e.jsxs("div",{style:{background:"#f0f6f7",border:"1px solid #d0e8eb",borderRadius:8,padding:"12px 16px",marginBottom:16,fontSize:12,color:"#555"},children:[e.jsx("strong",{style:{color:"#034D57"},children:"How it works:"})," Every outgoing email is processed through the signature filter (port 10024). It automatically appends the matching HTML signature + confidentiality disclaimer before delivery. To add or edit signatures, click ",e.jsx("strong",{children:"Open Manager"})," above."]}),e.jsx(B,{columns:M,dataSource:i,rowKey:"email",loading:w,size:"small",pagination:!1}),e.jsx(D,{title:`Signature Preview â€” ${v}`,open:!!u,onCancel:()=>s(null),footer:[e.jsx(o,{onClick:()=>s(null),children:"Close"},"close"),e.jsx(o,{type:"primary",icon:e.jsx(h,{}),onClick:()=>window.open(S,"_blank"),style:{background:"#034D57",borderColor:"#034D57"},children:"Edit in Manager"},"open")],width:700,children:e.jsx("div",{style:{border:"1px solid #e8f0f1",borderRadius:6,padding:16,background:"#fafafa"},children:e.jsx("div",{dangerouslySetInnerHTML:{__html:u}})})})]})}export{te as default};
