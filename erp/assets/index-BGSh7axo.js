import{m as v,r as n,j as t}from"./index-D8GYIxkt.js";import{aA as y,aB as u,aD as z,ai as j,ar as T,ay as _}from"./IdurarOs-Bp7g4t32.js";import{C as w}from"./index-12GqBLyk.js";import{S as R}from"./index-B6OjbFu5.js";import{F as B}from"./Table-C95qK4fz.js";import{T as F}from"./index-BapNQfCS.js";import{R as O}from"./ReloadOutlined-BgI3veQX.js";import"./Skeleton-BCG8SEaS.js";import"./index-BYBg9C3K.js";import"./ErpApp-eMQ7IvFe.js";import"./PlusOutlined-BPzt_4wX.js";import"./pickAttrs-Cgu4o-jt.js";import"./DownOutlined-PDxVrbmf.js";import"./useClosable-Cp59dJiR.js";function A(){var l,o;try{const d=(o=(l=JSON.parse(localStorage.getItem("auth")||"{}"))==null?void 0:l.current)==null?void 0:o.token;return d?{Authorization:`Bearer ${d}`}:{}}catch{return{}}}const{Title:D,Text:g}=T,{Option:i}=R;function ee(){const l=v(),[o,d]=n.useState([]),[C,x]=n.useState(!0),[c,I]=n.useState({current:1,pageSize:30,total:0}),[h,p]=n.useState(""),[f,P]=n.useState("all"),s=async(e=1,r=h,a=f)=>{x(!0);const N=new URLSearchParams({page:e,items:30,...r&&{fields:"partNumber,nsn,description",q:r},...a!=="all"&&{filter:"status",equal:a}}),m=await(await fetch(_+`part/list?${N}`,{headers:A()})).json();m.success!==!1&&(d(m.result||[]),I(q=>{var S;return{...q,current:e,total:((S=m.pagination)==null?void 0:S.count)||0}})),x(!1)};n.useEffect(()=>{s()},[]);const b={done:"success",pending:"default",researching:"processing",no_results:"warning"},k=[{title:"Part Number",dataIndex:"partNumber",key:"partNumber",width:150,render:e=>t.jsx(g,{strong:!0,style:{color:"#034D57"},children:e||"—"})},{title:"NSN",dataIndex:"nsn",key:"nsn",width:140,render:e=>e?t.jsx(g,{code:!0,style:{fontSize:12},children:e}):"—"},{title:"Description",dataIndex:"description",key:"description",ellipsis:!0,render:e=>e||"—"},{title:"Qty",dataIndex:"quantity",key:"quantity",width:60,align:"center"},{title:"Research",dataIndex:"status",key:"status",width:110,render:e=>t.jsx(F,{color:b[e]||"default",style:{fontSize:11},children:e})},{title:"Sell Price",dataIndex:"unitSellPrice",key:"unitSellPrice",width:110,align:"right",render:(e,r)=>{const a=e||r.unitCostOmr;return a?t.jsxs(g,{strong:!0,children:[a.toFixed(3)," OMR"]}):"—"}},{title:"RFQ",dataIndex:["rfq","rfqNumber"],key:"rfq",width:130,render:(e,r)=>{var a;return r.rfq?t.jsx(j,{type:"link",size:"small",style:{padding:0,color:"#034D57",fontSize:12},onClick:()=>l(`/rfq/${r.rfq._id||r.rfq}`),children:e||((a=r.rfq)==null?void 0:a.subject)||"→ View RFQ"}):"—"}}];return t.jsxs("div",{style:{paddingBottom:24},children:[t.jsx(y,{justify:"space-between",align:"middle",style:{marginBottom:16},children:t.jsx(u,{children:t.jsxs(D,{level:4,style:{margin:0,color:"#034D57"},children:["Parts Catalog — ",c.total.toLocaleString()]})})}),t.jsx(w,{style:{marginBottom:16,borderRadius:8},bodyStyle:{padding:"12px 16px"},children:t.jsxs(y,{gutter:[8,8],align:"middle",children:[t.jsx(u,{xs:24,sm:12,md:8,children:t.jsx(z.Search,{placeholder:"Search part #, NSN, description...",value:h,onChange:e=>p(e.target.value),onSearch:e=>{p(e),s(1,e)},allowClear:!0,onClear:()=>{p(""),s(1,"")}})}),t.jsx(u,{xs:12,sm:6,md:4,children:t.jsxs(R,{style:{width:"100%"},value:f,onChange:e=>{P(e),s(1,h,e)},children:[t.jsx(i,{value:"all",children:"All Status"}),t.jsx(i,{value:"done",children:"Researched"}),t.jsx(i,{value:"pending",children:"Pending"}),t.jsx(i,{value:"no_results",children:"No Results"}),t.jsx(i,{value:"researching",children:"In Progress"})]})}),t.jsx(u,{children:t.jsx(j,{icon:t.jsx(O,{}),onClick:()=>s(),children:"Refresh"})})]})}),t.jsx(w,{style:{borderRadius:8},bodyStyle:{padding:0},children:t.jsx("div",{style:{overflowX:"auto"},children:t.jsx(B,{dataSource:o,columns:k,rowKey:"_id",loading:C,size:"small",pagination:{current:c.current,pageSize:c.pageSize,total:c.total,showSizeChanger:!1,showTotal:e=>`${e} parts`,onChange:e=>s(e)}})})})]})}export{ee as default};
