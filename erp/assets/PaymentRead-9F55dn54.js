import{n as T,m as S,u as g,r as l,j as e,o as R,P as O}from"./index-Cv8bzOR9.js";import{ai as c,ay as k,al as B,ax as M,aB as y,aJ as E,aC as a,ar as F,an as _}from"./IdurarOs-CQv8Asqq.js";import"./index-DQy8ZYPb.js";import{c as w,b as W,E as Y}from"./selectors-Dc1-zjLy.js";import{P as H}from"./index-Dvq3kPns.js";import{e as f}from"./actions-CX6UvuCj.js";import{s as d}from"./index-KrFx5yLV.js";import{u as J}from"./useMoney-BJnY9M22.js";import{F as U}from"./ErpApp-B0emHUSr.js";import{u as q}from"./useMail-Bl7pArY5.js";import{S as m}from"./index-Buu66tqe.js";import{D as u}from"./index-DLyyIiXL.js";import{E as z}from"./ExportOutlined-D6bjjam2.js";import{C as G}from"./CloseCircleOutlined-B7R6F1P6.js";import"./index-t1r7-Of0.js";import"./dayjs.min-CdYvzGbP.js";import"./Breadcrumb-D1NJa4uq.js";import"./pickAttrs-BLk2Kv7u.js";import"./DownOutlined-BsmJb_vG.js";import"./currency.es-9OAR_aOO.js";import"./Skeleton-1YwFyHrx.js";function K({config:n,selectedItem:o}){const s=_(),{entity:r,ENTITY_NAME:p}=n,C=T(),{moneyFormatter:i}=J(),{send:N,isLoading:P}=q({entity:r}),x=S(),{result:h}=g(w),$={status:"",client:{name:"",email:"",phone:"",address:""},subTotal:0,taxTotal:0,taxRate:0,total:0,credit:0,number:0,year:0},[t,I]=l.useState(o??$),[j,b]=l.useState({});return l.useEffect(()=>{const A=new AbortController;if(h){const{invoice:L,_id:v,...D}=h;I({...D,...L,_id:v})}return()=>A.abort()},[h]),l.useEffect(()=>{t!=null&&t.client&&b(t.client)},[t]),e.jsxs(e.Fragment,{children:[e.jsx(H,{onBack:()=>{x(`/${r.toLowerCase()}`)},title:`${p} # ${t.number}/${t.year||""}`,ghost:!1,tags:e.jsx("span",{children:t.paymentStatus}),extra:[e.jsx(c,{onClick:()=>{x(`/${r.toLowerCase()}`)},icon:e.jsx(G,{}),children:s("Close")},`${d.generate()}`),e.jsx(c,{onClick:()=>{window.open(`${k}${r}/${r}-${t._id}.pdf`,"_blank")},icon:e.jsx(U,{}),children:s("Download PDF")},`${d.generate()}`),e.jsx(c,{loading:P,onClick:()=>{N(t._id)},icon:e.jsx(B,{}),children:s("Send by email")},`${d.generate()}`),e.jsx(c,{onClick:()=>{C(f.currentAction({actionType:"update",data:t})),x(`/${r.toLowerCase()}/update/${t._id}`)},type:"primary",icon:e.jsx(M,{}),children:s("Edit")},`${d.generate()}`)],style:{padding:"20px 0px"},children:e.jsxs(y,{children:[e.jsx(m,{title:"Status",value:t.status}),e.jsx(m,{title:s("Paid"),value:i({amount:t.amount,currency_code:t.currency}),style:{margin:"0 32px"}}),e.jsx(m,{title:s("SubTotal"),value:i({amount:t.subTotal,currency_code:t.currency}),style:{margin:"0 32px"}}),e.jsx(m,{title:s("Total"),value:i({amount:t.total,currency_code:t.currency}),style:{margin:"0 32px"}})]})}),e.jsx(E,{dashed:!0}),e.jsxs(u,{title:`${s("Client")} : ${t.client.name}`,children:[e.jsx(u.Item,{label:s("Address"),children:j.address}),e.jsx(u.Item,{label:s("email"),children:j.email}),e.jsx(u.Item,{label:s("Phone"),children:j.phone})]}),e.jsx(E,{}),e.jsxs(y,{children:[e.jsx(a,{sm:24,md:12,children:e.jsxs(F.Title,{level:5,children:[s("Payment Information")," :"]})}),e.jsx(a,{sm:24,md:12,style:{textAlign:"right"},children:e.jsx(c,{icon:e.jsx(z,{}),children:s("Show invoice")})})]}),e.jsx("div",{style:{width:"300px",float:"left",textAlign:"right",fontWeight:"700"},children:e.jsxs(y,{gutter:[12,-5],children:[e.jsx(a,{className:"gutter-row",span:12,children:e.jsxs("p",{children:[s("Paid")," :"]})}),e.jsx(a,{className:"gutter-row",span:12,children:e.jsx("p",{children:i({amount:t.amount,currency_code:t.currency})})}),e.jsx(a,{className:"gutter-row",span:12,children:e.jsxs("p",{children:[s("Total")," :"]})}),e.jsx(a,{className:"gutter-row",span:12,children:e.jsx("p",{children:i({amount:t.total,currency_code:t.currency})})}),e.jsx(a,{className:"gutter-row",span:12,children:e.jsxs("p",{children:[s("Total Paid")," :"]})}),e.jsx(a,{className:"gutter-row",span:12,children:e.jsx("p",{children:i({amount:t.credit,currency_code:t.currency})})}),e.jsx(a,{className:"gutter-row",span:12,children:e.jsxs("p",{children:[s("Total Remaining")," :"]})}),e.jsx(a,{className:"gutter-row",span:12,children:e.jsx("p",{children:i({amount:t.total-t.credit,currency_code:t.currency})})})]})})]})}function Q({config:n}){const o=T(),{id:s}=R();let r=g(W(s));l.useEffect(()=>{o(r?f.currentItem({data:r}):f.read({entity:n.entity,id:s}))},[r]);const{result:p}=g(w);return r=p,e.jsx(Y,{children:r?e.jsx(K,{config:n,selectedItem:r}):e.jsx(O,{})})}function ge(){const n=_(),o="payment",s={PANEL_TITLE:n("payment"),DATATABLE_TITLE:n("payment_list"),ADD_NEW_ENTITY:n("add_new_payment"),ENTITY_NAME:n("payment")},r={entity:o,...s};return e.jsx(Q,{config:r})}export{ge as default};
