import{o as T,m as B,r as n,j as e}from"./index-BnwzPVl3.js";import{aV as E,aN as L,aB as R,aM as q,aL as $,aY as w}from"./IdurarOs-C_8FWDwN.js";import{l as z,T as y,O as I,b as N,a as F,C as _,f as k,ai as D}from"./ErpApp-DAT-Lv-2.js";import{C as h}from"./index-CcPbW-4d.js";import{S as P}from"./index-CaXkTdFM.js";import{T as j}from"./Timeline-BS-7fIyx.js";import{A as U}from"./ArrowLeftOutlined-CTsXIjf8.js";import{C as W}from"./ClockCircleOutlined-CU-M3lCR.js";import"./Skeleton-VwHRjmeX.js";import"./index-wigWtylq.js";import"./PlusOutlined-CfM5Z-xV.js";const{Title:G,Text:c}=w,S="#034D57",M="#4CB480";function Q(){var o,a;try{const i=(a=(o=JSON.parse(localStorage.getItem("auth")||"{}"))==null?void 0:o.current)==null?void 0:a.token;return i?{Authorization:`Bearer ${i}`}:{}}catch{return{}}}const d={rfq:{icon:e.jsx(N,{}),color:"#1890ff",label:"RFQ"},quote:{icon:e.jsx(F,{}),color:M,label:"Quote"},invoice:{icon:e.jsx(_,{}),color:"#fa8c16",label:"Invoice"},payment:{icon:e.jsx(k,{}),color:"#52c41a",label:"Payment"},po:{icon:e.jsx(D,{}),color:"#722ed1",label:"PO"}},Y={new:"blue",in_progress:"processing",researched:"purple",quoted:"cyan",draft:"default",sent:"processing",approved:"green",paid:"blue",won:"green",lost:"red",expired:"default",overdue:"red"};function ae(){const{id:o}=T(),a=B(),[i,u]=n.useState(!0),[v,C]=n.useState(null),[p,m]=n.useState(null),x=n.useCallback(async()=>{u(!0);try{const r=await(await fetch(`${E}client/activity/${o}`,{headers:Q()})).json();r.success?C(r):m("Failed to load activity")}catch(t){m(t.message)}u(!1)},[o]);if(n.useEffect(()=>{x()},[x]),i)return e.jsx("div",{style:{textAlign:"center",padding:80},children:e.jsx(L,{size:"large"})});if(p)return e.jsx("div",{style:{textAlign:"center",padding:80},children:e.jsx(c,{type:"danger",children:p})});const{result:f=[],client:b={},counts:O={}}=v||{},A=t=>{const r={rfq:`/rfq/${t.id}`,quote:`/quote/read/${t.id}`,invoice:`/invoice/read/${t.id}`,payment:`/payment/read/${t.id}`,po:`/purchase-order/read/${t.id}`};r[t.type]&&a(r[t.type])};return e.jsxs("div",{style:{padding:"24px",maxWidth:1e3,margin:"0 auto"},children:[e.jsx(R,{icon:e.jsx(U,{}),onClick:()=>a("/customer"),style:{marginBottom:16},children:"Back to Clients"}),e.jsxs(G,{level:3,style:{color:S,marginBottom:20},children:[b.name," â€” Activity"]}),e.jsx(q,{gutter:[16,16],style:{marginBottom:24},children:Object.entries(O).map(([t,r])=>{var s,l;return e.jsx($,{xs:12,sm:8,md:4,children:e.jsx(h,{size:"small",style:{borderRadius:8,textAlign:"center"},children:e.jsx(P,{title:t.toUpperCase(),value:r,valueStyle:{color:((s=d[t])==null?void 0:s.color)||S,fontSize:24,fontWeight:800},prefix:(l=d[t])==null?void 0:l.icon})})},t)})}),f.length===0?e.jsx(z,{description:"No activity found for this client"}):e.jsx(h,{style:{borderRadius:12},children:e.jsx(j,{mode:"left",children:f.map((t,r)=>{var g;const s=d[t.type]||d.rfq,l=t.date?new Date(t.date).toLocaleDateString("en-GB",{timeZone:"Asia/Muscat",day:"2-digit",month:"short",year:"numeric"}):"";return e.jsx(j.Item,{color:s.color,dot:e.jsx("span",{style:{fontSize:16},children:s.icon}),children:e.jsxs("div",{style:{cursor:"pointer",padding:"4px 0"},onClick:()=>A(t),children:[e.jsx(y,{color:s.color,style:{fontWeight:600,marginRight:8},children:s.label}),e.jsx(c,{strong:!0,style:{color:"#333"},children:t.summary}),t.status&&e.jsx(y,{color:Y[t.status]||"default",style:{marginLeft:8},children:(g=t.status)==null?void 0:g.replace("_"," ")}),(t.total||t.amount)&&e.jsxs("span",{style:{marginLeft:8,display:"inline-flex",alignItems:"center",gap:3},children:[e.jsx(I,{size:11}),e.jsx(c,{style:{fontWeight:600},children:Number(t.total||t.amount||0).toLocaleString("en-US",{minimumFractionDigits:3})})]}),e.jsx("br",{}),e.jsxs(c,{type:"secondary",style:{fontSize:11},children:[e.jsx(W,{style:{marginRight:4}}),l]})]})},r)})})})]})}export{ae as default};
