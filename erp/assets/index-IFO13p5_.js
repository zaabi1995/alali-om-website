import{m as P,r as n,j as e}from"./index-CB_AWKJY.js";import{aM as z,aL as m,aX as B,aB as I,aY as T,aV as E,aS as F}from"./IdurarOs-20-QWMXR.js";import{C as b}from"./index-ByWerc77.js";import{F as _}from"./Table-r_Zm9lDt.js";import{G as A}from"./GlobalOutlined-BNP4QtSf.js";import{T as C,l as y}from"./ErpApp-Cy5crc22.js";import{P as D}from"./PhoneOutlined-BY1b4KUP.js";import{T as L,S as O}from"./TrophyFilled-DOnrSlNw.js";import{R as $}from"./ReloadOutlined-4WpUn4n7.js";import"./Skeleton-C4FpL5iW.js";import"./index-2JQk6u8I.js";import"./PlusOutlined-YO2bg1HW.js";function G(){var l,c;try{const d=(c=(l=JSON.parse(localStorage.getItem("auth")||"{}"))==null?void 0:l.current)==null?void 0:c.token;return d?{Authorization:`Bearer ${d}`}:{}}catch{return{}}}const{Title:M,Text:o}=T;function te(){const l=P(),[c,d]=n.useState([]),[w,x]=n.useState(!0),[p,k]=n.useState({current:1,pageSize:25,total:0}),[v,R]=n.useState(""),[h,S]=n.useState(""),i=async(t=1,r=v)=>{x(!0);const s=new URLSearchParams({page:t,items:25,...r&&{fields:"companyName,website,country,contactEmail",q:r}}),a=await(await fetch(E+`vendor/list?${s}`,{headers:G()})).json();a.success!==!1&&(d(a.result||[]),k(u=>{var j;return{...u,current:t,total:((j=a.pagination)==null?void 0:j.count)||0}})),x(!1)};n.useEffect(()=>{i()},[]);const f=()=>{R(h),i(1,h)},N=[{title:"Supplier Name",dataIndex:"companyName",key:"companyName",render:(t,r)=>{var s;return e.jsxs("div",{children:[e.jsx(o,{strong:!0,style:{color:"#034D57",fontSize:13},children:t||"—"}),r.website&&e.jsx("div",{children:e.jsxs("a",{href:r.website.startsWith("http")?r.website:`https://${r.website}`,target:"_blank",rel:"noreferrer",style:{fontSize:11,color:"#1890ff"},children:[e.jsx(A,{})," ",(s=r.website)==null?void 0:s.replace(/^https?:\/\//,"")]})})]})}},{title:"Country",dataIndex:"country",key:"country",width:100,render:t=>t?e.jsx(C,{style:{fontSize:11},children:t}):"—"},{title:"Contact",key:"contact",width:220,render:(t,r)=>e.jsxs(y,{direction:"vertical",size:2,children:[r.contactEmail&&e.jsxs(o,{style:{fontSize:12},children:[e.jsx(F,{})," ",r.contactEmail]}),r.contactPhone&&e.jsxs(o,{style:{fontSize:12},children:[e.jsx(D,{})," ",r.contactPhone]})]})},{title:"Specialties",dataIndex:"specialties",key:"specialties",ellipsis:!0,render:t=>Array.isArray(t)&&t.length?t.slice(0,3).map((r,s)=>e.jsx(C,{style:{fontSize:11,margin:"1px 2px"},children:r},s)):"—"},{title:"Performance",key:"performance",width:130,render:(t,r)=>{const s=r.badge||"None",g=r.performanceScore||0,a=r.totalRatings||0;if(a===0)return e.jsx(o,{type:"secondary",style:{fontSize:11},children:"Not rated"});const u={Gold:"#FFD700",Silver:"#C0C0C0",Bronze:"#CD7F32",None:"#d9d9d9"};return e.jsxs(y,{size:4,direction:"vertical",children:[e.jsxs(y,{size:4,children:[s!=="None"&&e.jsx(L,{style:{color:u[s],fontSize:14}}),e.jsxs(o,{strong:!0,style:{fontSize:12},children:[e.jsx(O,{style:{color:"#faad14",fontSize:11}})," ",g.toFixed(1),"/5"]})]}),e.jsxs(o,{type:"secondary",style:{fontSize:10},children:[a," rating",a!==1?"s":""]})]})}},{title:"Added",dataIndex:"created",key:"created",width:100,render:t=>t?new Date(t).toLocaleDateString("en-GB"):"—"}];return e.jsxs("div",{style:{paddingBottom:24},children:[e.jsx(z,{justify:"space-between",align:"middle",style:{marginBottom:16},children:e.jsx(m,{children:e.jsxs(M,{level:4,style:{margin:0,color:"#034D57"},children:["Suppliers — ",p.total.toLocaleString()]})})}),e.jsx(b,{style:{marginBottom:16,borderRadius:8},bodyStyle:{padding:"12px 16px"},children:e.jsxs(z,{gutter:[8,8],align:"middle",children:[e.jsx(m,{xs:24,sm:12,md:8,children:e.jsx(B.Search,{placeholder:"Search by name, country, website...",value:h,onChange:t=>S(t.target.value),onSearch:f,onPressEnter:f,allowClear:!0,onClear:()=>{S(""),i(1,"")}})}),e.jsx(m,{children:e.jsx(I,{icon:e.jsx($,{}),onClick:()=>i(),children:"Refresh"})})]})}),e.jsx(b,{style:{borderRadius:8},bodyStyle:{padding:0},children:e.jsx("div",{style:{overflowX:"auto"},children:e.jsx(_,{dataSource:c,columns:N,rowKey:"_id",loading:w,size:"small",onRow:t=>({onClick:()=>l(`/suppliers/${t._id}`),style:{cursor:"pointer"}}),pagination:{current:p.current,pageSize:p.pageSize,total:p.total,showSizeChanger:!1,showTotal:t=>`${t} suppliers`,onChange:t=>i(t)}})})})]})}export{te as default};
