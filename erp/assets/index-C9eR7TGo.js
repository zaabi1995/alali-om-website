import{r as n,j as e}from"./index-DsxgoXaO.js";import{a as m,o as s}from"./omrFormat-C3L8_xkq.js";import{m as B,f as z,h as u,n as P,T}from"./ErpApp-3NZWEkOD.js";import{O as H,g as F,aV as S,aB as y,U as O,aM as R,aL as h,aY as V}from"./IdurarOs-BmcscLXI.js";import{C as x}from"./index-D7xQuJHc.js";import{S as f}from"./index-BSG--CcV.js";import{F as l}from"./Table-B_wqoxqg.js";import{D as k}from"./index-Cw-1tx-x.js";import"./Skeleton-DKI-OLNZ.js";import"./index-HED-hjAe.js";import"./PlusOutlined-C2sCGP9k.js";var A={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M820 436h-40c-4.4 0-8 3.6-8 8v40c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-40c0-4.4-3.6-8-8-8zm32-104H732V120c0-4.4-3.6-8-8-8H300c-4.4 0-8 3.6-8 8v212H172c-44.2 0-80 35.8-80 80v328c0 17.7 14.3 32 32 32h168v132c0 4.4 3.6 8 8 8h424c4.4 0 8-3.6 8-8V772h168c17.7 0 32-14.3 32-32V412c0-44.2-35.8-80-80-80zM360 180h304v152H360V180zm304 664H360V568h304v276zm200-140H732V500H292v204H160V412c0-6.6 5.4-12 12-12h680c6.6 0 12 5.4 12 12v292z"}}]},name:"printer",theme:"outlined"},L=function(d,i){return n.createElement(H,F({},d,{ref:i,icon:A}))};const _=n.forwardRef(L),{Title:E,Text:U}=V,{RangePicker:$}=k;function C(){return{Authorization:`Bearer ${((JSON.parse(localStorage.getItem("auth"))||{}).current||{}).token}`}}function ae(){var g;const[p,d]=n.useState([]),[i,v]=n.useState(null),[a,Y]=n.useState(null),[b,j]=n.useState(!1),[o,w]=n.useState([null,null]);n.useEffect(()=>{fetch(S+"client/listAll",{headers:C()}).then(t=>t.json()).then(t=>t.result&&d(t.result)).catch(()=>{})},[]);const D=async()=>{if(!i)return;j(!0);const t=new URLSearchParams;o[0]&&t.set("from",o[0].format("YYYY-MM-DD")),o[1]&&t.set("to",o[1].format("YYYY-MM-DD"));const r=await fetch(S+`reports/customer-statement/${i}?${t}`,{headers:C()}).then(c=>c.json()).catch(()=>({}));r.success&&Y(r.result),j(!1)},I={paid:"green",partial:"orange",unpaid:"red",overdue:"volcano"},M=[{title:"Date",dataIndex:"date",width:110,render:t=>u(t).format("DD MMM YYYY")},{title:"Invoice",dataIndex:"number",width:110,render:(t,r)=>e.jsxs("b",{children:["INV-",t,"/",r.year]})},{title:"Total",dataIndex:"total",align:"right",render:t=>s(t)},{title:"Paid",dataIndex:"credit",align:"right",render:t=>e.jsx("span",{style:{color:"#4CB480"},children:s(t||0)})},{title:"Balance",align:"right",render:(t,r)=>{const c=(r.total||0)-(r.credit||0);return e.jsx("b",{style:{color:c>0?"#e53e3e":"#4CB480"},children:s(c)})}},{title:"Due Date",dataIndex:"expiredDate",width:110,render:t=>t?u(t).format("DD MMM YYYY"):"—"},{title:"Status",dataIndex:"paymentStatus",width:90,render:t=>e.jsx(T,{color:I[t],children:t==null?void 0:t.toUpperCase()})}];return e.jsxs("div",{style:{padding:24},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[e.jsx(E,{level:4,style:{margin:0,color:"#034D57"},children:"Customer Statement"}),a&&e.jsx(y,{icon:e.jsx(_,{}),onClick:()=>window.print(),children:"Print"})]}),e.jsx(x,{size:"small",style:{marginBottom:20},children:e.jsxs(B,{wrap:!0,children:[e.jsx(z,{showSearch:!0,placeholder:"Select customer",style:{minWidth:260},onChange:t=>v(t),filterOption:(t,r)=>r.label.toLowerCase().includes(t.toLowerCase()),options:p.map(t=>({value:t._id,label:t.name}))}),e.jsx($,{onChange:t=>w(t||[null,null]),style:{width:240}}),e.jsx(y,{type:"primary",icon:e.jsx(O,{}),onClick:D,loading:b,style:{background:"#034D57"},disabled:!i,children:"Generate"})]})}),a?e.jsxs(e.Fragment,{children:[e.jsx(x,{title:e.jsxs(e.Fragment,{children:[e.jsx("b",{children:(g=a.client)==null?void 0:g.name})," — Account Statement"]}),size:"small",style:{marginBottom:16},extra:e.jsxs(U,{type:"secondary",style:{fontSize:12},children:["Generated ",u().format("DD MMM YYYY HH:mm")]}),children:e.jsxs(R,{gutter:12,children:[e.jsx(h,{xs:8,children:e.jsx(f,{title:"Total Invoiced",value:parseFloat(a.totalInvoiced||0).toFixed(3),suffix:m(),valueStyle:{color:"#034D57",fontSize:16}})}),e.jsx(h,{xs:8,children:e.jsx(f,{title:"Total Paid",value:parseFloat(a.totalPaid||0).toFixed(3),suffix:m(),valueStyle:{color:"#4CB480",fontSize:16}})}),e.jsx(h,{xs:8,children:e.jsx(f,{title:"Outstanding Balance",value:parseFloat(a.balance||0).toFixed(3),suffix:m(),valueStyle:{color:a.balance>0?"#e53e3e":"#4CB480",fontSize:16,fontWeight:700}})})]})}),e.jsx(l,{columns:M,dataSource:a.invoices||[],rowKey:"_id",size:"small",pagination:{pageSize:20},summary:()=>e.jsxs(l.Summary.Row,{style:{background:"#f5f5f5"},children:[e.jsx(l.Summary.Cell,{colSpan:2,children:e.jsx("b",{children:"TOTAL"})}),e.jsx(l.Summary.Cell,{align:"right",children:e.jsx("b",{children:s(a.totalInvoiced||0)})}),e.jsx(l.Summary.Cell,{align:"right",children:e.jsx("b",{style:{color:"#4CB480"},children:s(a.totalPaid||0)})}),e.jsx(l.Summary.Cell,{align:"right",children:e.jsx("b",{style:{color:"#e53e3e"},children:s(a.balance||0)})}),e.jsx(l.Summary.Cell,{colSpan:2})]})})]}):e.jsx(x,{children:e.jsx(P,{description:"Select a customer and click Generate"})})]})}export{ae as default};
