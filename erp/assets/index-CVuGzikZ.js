import{m as D,o as S,r as u,j as e}from"./index-oPQXoYKp.js";import{a as F}from"./omrFormat-CTPzY_NN.js";import{d as h}from"./dayjs.min-5mc2clVM.js";import{ay as p,ai as c,aw as I,aA as C,aB as s,ar as B}from"./IdurarOs-C96gq07Y.js";import{j}from"./ErpApp-CyTf16cV.js";import{T as $}from"./index-n_BILCLw.js";import{P as z}from"./index-DFSXAye9.js";import{C as l}from"./index-BahwpbKO.js";import{S as o}from"./index-mcUi6KUU.js";import{D as a}from"./index-CGUhesR_.js";import{F as n}from"./Table-m48CDhBr.js";import{s as O}from"./index-BWf8pZWf.js";import{A as T}from"./ArrowLeftOutlined-CkhHFTDI.js";import{D as R}from"./DeleteOutlined-DPucJX-F.js";import"./useClosable-53lTmkbd.js";import"./ActionButton-C2bzXVGM.js";import"./Skeleton-C38J3ij6.js";import"./index-AV0JXaN1.js";import"./PlusOutlined-CiaR4XPW.js";import"./pickAttrs-D_cBXNK5.js";import"./index-DqaMeVXh.js";import"./DownOutlined-BARTIFlJ.js";const{Title:E}=B;function f(){return{Authorization:`Bearer ${localStorage.getItem("x-auth-token")}`}}const P={draft:"default",received:"blue",approved:"cyan",partially_paid:"orange",paid:"green",overdue:"red",cancelled:"default"};function ae(){var m,x;const d=D(),{id:i}=S(),[t,y]=u.useState(null);u.useEffect(()=>{fetch(p+`vendorbill/read/${i}`,{headers:f()}).then(r=>r.json()).then(r=>{r.success&&y(r.result)}).catch(()=>{})},[i]);const g=async()=>{await fetch(p+`vendorbill/delete/${i}`,{method:"DELETE",headers:f()}),O.success("Deleted"),d("/vendor-bill")};if(!t)return e.jsx("div",{style:{padding:24},children:"Loading…"});const b=[{title:"Description",dataIndex:"description"},{title:"Qty",dataIndex:"quantity",width:80,align:"right"},{title:"Unit Price",dataIndex:"unitPrice",align:"right",render:r=>`${parseFloat(r||0).toFixed(4)} ${t.currency}`},{title:"Total",dataIndex:"total",align:"right",render:r=>e.jsxs("b",{children:[parseFloat(r||0).toFixed(3)," ",t.currency]})}];return e.jsxs("div",{style:{padding:24,maxWidth:900},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsxs(j,{children:[e.jsx(c,{icon:e.jsx(T,{}),onClick:()=>d("/vendor-bill")}),e.jsxs(E,{level:4,style:{margin:0,color:"#034D57"},children:["BILL-",t.number,"/",t.year]}),e.jsx($,{color:P[t.status],children:(m=t.status)==null?void 0:m.replace(/_/g," ").toUpperCase()})]}),e.jsxs(j,{children:[e.jsx(c,{icon:e.jsx(I,{}),onClick:()=>d(`/vendor-bill/edit/${i}`),children:"Edit"}),e.jsx(z,{title:"Delete this bill?",onConfirm:g,children:e.jsx(c,{danger:!0,icon:e.jsx(R,{}),children:"Delete"})})]})]}),e.jsxs(C,{gutter:12,style:{marginBottom:16},children:[e.jsx(s,{xs:12,sm:6,children:e.jsx(l,{size:"small",children:e.jsx(o,{title:"Total",value:`${parseFloat(t.total||0).toFixed(3)} ${t.currency}`,valueStyle:{fontSize:14,color:"#034D57"}})})}),e.jsx(s,{xs:12,sm:6,children:e.jsx(l,{size:"small",children:e.jsx(o,{title:"Paid",value:`${parseFloat(t.amountPaid||0).toFixed(3)} ${t.currency}`,valueStyle:{fontSize:14,color:"#4CB480"}})})}),e.jsx(s,{xs:12,sm:6,children:e.jsx(l,{size:"small",children:e.jsx(o,{title:"Balance Due",value:`${parseFloat(t.balanceDue||0).toFixed(3)} ${t.currency}`,valueStyle:{fontSize:14,color:t.balanceDue>0?"#e53e3e":"#4CB480",fontWeight:700}})})}),e.jsx(s,{xs:12,sm:6,children:e.jsx(l,{size:"small",children:e.jsx(o,{title:"OMR Equivalent",value:parseFloat(t.totalOMR||0).toFixed(3),suffix:F(),valueStyle:{fontSize:14}})})})]}),e.jsx(l,{title:"Bill Details",size:"small",style:{marginBottom:16},children:e.jsxs(a,{column:{xs:1,sm:2},bordered:!0,size:"small",children:[e.jsx(a.Item,{label:"Vendor",children:e.jsx("b",{children:((x=t.vendor)==null?void 0:x.companyName)||"—"})}),e.jsx(a.Item,{label:"Vendor Invoice #",children:t.vendorRef||"—"}),e.jsx(a.Item,{label:"Bill Date",children:t.date?h(t.date).format("DD MMM YYYY"):"—"}),e.jsx(a.Item,{label:"Due Date",children:t.dueDate?h(t.dueDate).format("DD MMM YYYY"):"—"}),e.jsxs(a.Item,{label:"Currency",children:[t.currency," (rate: ",t.exchangeRate||1,")"]}),e.jsx(a.Item,{label:"Linked PO",children:t.purchaseOrder?`PO-${t.purchaseOrder.number}/${t.purchaseOrder.year}`:"—"}),e.jsxs(a.Item,{label:"Tax",children:[parseFloat(t.taxAmount||0).toFixed(3)," ",t.currency]}),t.notes&&e.jsx(a.Item,{label:"Notes",span:2,children:t.notes})]})}),e.jsx(l,{title:"Line Items",size:"small",children:e.jsx(n,{columns:b,dataSource:t.items||[],rowKey:(r,v)=>v,pagination:!1,size:"small",summary:()=>e.jsxs(n.Summary.Row,{children:[e.jsx(n.Summary.Cell,{index:0,colSpan:3,align:"right",children:e.jsx("b",{children:"Total"})}),e.jsx(n.Summary.Cell,{index:1,align:"right",children:e.jsxs("b",{style:{color:"#034D57"},children:[parseFloat(t.total||0).toFixed(3)," ",t.currency]})})]})})})]})}export{ae as default};
