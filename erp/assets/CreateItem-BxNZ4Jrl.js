import{n as q,m as O,r as c,u as A,j as t}from"./index-BolfsKLq.js";import{P as D}from"./index-5QZIq2jV.js";import{aH as C,ai as b,aJ as E,aK as I,an as L}from"./IdurarOs-ImGZrK6V.js";import{f as B}from"./ErpApp-CPyzesRl.js";import{e as S}from"./actions-B1rsRoxl.js";import{d as H}from"./selectors-ma4WmJXd.js";import{c as r}from"./calculate-CoT1A6Sl.js";import{s as T}from"./index-KrFx5yLV.js";import{T as N}from"./index-HROpVfrd.js";import{C as J}from"./CloseCircleOutlined-BF3w6pXb.js";import{A as K}from"./ArrowLeftOutlined-CS_jDWyb.js";import{P as R}from"./PlusOutlined-CXeZI9c1.js";function _({form:l}){const u=L(),o=()=>{l.submit()};return t.jsx(b,{onClick:o,type:"primary",icon:t.jsx(R,{}),children:u("Save")})}function st({config:l,CreateForm:u}){const o=L(),f=q(),m=O();c.useEffect(()=>{f(B.list({entity:"setting"}))},[]);let{entity:n}=l;const{isLoading:v,isSuccess:h,result:w}=A(H),[p]=C.useForm(),[F,j]=c.useState(0),[P,y]=c.useState(0),$=(s,i)=>{const a=i.items;let d=0,g=0;a&&(a.map(e=>{if(e){if(e.offerPrice&&e.quantity){let x=r.multiply(e.quantity,e.offerPrice);g=r.add(g,x)}if(e.quantity&&e.price){let x=r.multiply(e.quantity,e.price);d=r.add(d,x)}}}),j(d),y(g))};c.useEffect(()=>(h&&(p.resetFields(),f(S.resetAction({actionType:"create"})),j(0),y(0),m(`/${n.toLowerCase()}/read/${w._id}`)),()=>{}),[h]);const k=s=>{if(console.log("ðŸš€ ~ onSubmit ~ fieldsValue:",s),s&&s.items){let i=[...s.items];i.map(a=>{a.total=r.multiply(a.quantity,a.price)}),s={...s,items:i}}f(S.create({entity:n,jsonData:s}))};return t.jsxs(t.Fragment,{children:[t.jsx(D,{onBack:()=>{m(`/${n.toLowerCase()}`)},backIcon:t.jsx(K,{}),title:o("New"),ghost:!1,tags:t.jsx(N,{children:o("Draft")}),extra:[t.jsx(b,{onClick:()=>m(`/${n.toLowerCase()}`),icon:t.jsx(J,{}),children:o("Cancel")},`${T.generate()}`),t.jsx(_,{form:p},`${T.generate()}`)],style:{padding:"20px 0px"}}),t.jsx(E,{dashed:!0}),t.jsx(I,{isLoading:v,children:t.jsx(C,{form:p,layout:"vertical",onFinish:k,onValuesChange:$,children:t.jsx(u,{subTotal:F,offerTotal:P})})})]})}export{st as C};
