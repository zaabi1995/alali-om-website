import{r as s,j as e}from"./index-fQzVIFut.js";import{C as i}from"./index-CcNtqXvO.js";import{r as j,a5 as u,d as C,a6 as h,T as w}from"./ErpApp-uJl2ak2H.js";import{O as A,g as k,b1 as R,aB as l,aM as O,aL as o,aS as D,aY as z}from"./IdurarOs-2nFZV4nX.js";import{A as B}from"./index-CljJJlns.js";import{S as c}from"./index-CmeX8ruA.js";import{R as I}from"./ReloadOutlined-BDMv4kPX.js";import{E as b}from"./ExportOutlined-BxtFrwTZ.js";import{W as G}from"./WarningOutlined-DkdTVoUH.js";import"./Skeleton-C1nKWVYB.js";import"./index-NwmM02iY.js";import"./PlusOutlined-DGREacQj.js";var L={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 305H624V192c0-17.7-14.3-32-32-32H184v-40c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v784c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V640h248v113c0 17.7 14.3 32 32 32h416c17.7 0 32-14.3 32-32V337c0-17.7-14.3-32-32-32zM184 568V232h368v336H184zm656 145H504v-73h112c4.4 0 8-3.6 8-8V377h216v336z"}}]},name:"flag",theme:"outlined"},P=function(a,r){return s.createElement(A,k({},a,{ref:r,icon:L}))};const T=s.forwardRef(P),{Title:v,Text:x}=z,W=["ali.ghalib@alali.om","ali.alzaabi@alali.om"],f="https://alali.om/phishguard/admin";function E(){var t;try{const a=JSON.parse(localStorage.getItem("auth")||"{}");return W.includes(((t=a==null?void 0:a.current)==null?void 0:t.email)||"")}catch{return!1}}function M(t){return t==="active"?"green":t==="completed"?"blue":"default"}function Q(){var m;const[t,a]=s.useState(null),[r,g]=s.useState(!0),[S,d]=s.useState(!1),p=async()=>{g(!0),d(!1);try{const y=await(await fetch("/phishguard/api/stats/public")).json();y.ok?a(y):d(!0)}catch{d(!0)}finally{g(!1)}};return s.useEffect(()=>{p()},[]),E()?e.jsxs("div",{style:{padding:"16px 24px",maxWidth:900,margin:"0 auto"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",flexWrap:"wrap",gap:12,marginBottom:20},children:[e.jsxs(j,{align:"center",children:[e.jsx(u,{style:{fontSize:28,color:"#034D57"}}),e.jsxs("div",{children:[e.jsx(v,{level:3,style:{margin:0,color:"#034D57"},children:"PhishGuard"}),e.jsx(x,{type:"secondary",children:"Phishing simulation & employee security awareness"})]})]}),e.jsxs(j,{wrap:!0,children:[e.jsx(l,{icon:e.jsx(I,{}),onClick:p,loading:r,children:"Refresh"}),e.jsx(l,{type:"primary",icon:e.jsx(b,{}),size:"large",style:{background:"#034D57",borderColor:"#034D57"},onClick:()=>window.open(f,"_blank"),children:"Open PhishGuard"})]})]}),S&&e.jsx(B,{type:"warning",message:"Could not load live stats — PhishGuard service may be restarting.",showIcon:!0,style:{marginBottom:16}}),e.jsxs(O,{gutter:[16,16],style:{marginBottom:20},children:[e.jsx(o,{xs:12,sm:6,children:e.jsx(i,{bordered:!1,style:{background:"#f0f9f6",borderRadius:10,textAlign:"center"},children:e.jsx(c,{title:"Campaigns",value:r?"—":(t==null?void 0:t.campaigns)??0,prefix:e.jsx(T,{style:{color:"#034D57"}}),valueStyle:{color:"#034D57",fontWeight:700}})})}),e.jsx(o,{xs:12,sm:6,children:e.jsx(i,{bordered:!1,style:{background:"#f6ffed",borderRadius:10,textAlign:"center"},children:e.jsx(c,{title:"Active Now",value:r?"—":(t==null?void 0:t.active)??0,prefix:e.jsx(u,{style:{color:"#4CB480"}}),valueStyle:{color:"#4CB480",fontWeight:700}})})}),e.jsx(o,{xs:12,sm:6,children:e.jsx(i,{bordered:!1,style:{background:"#fff7e6",borderRadius:10,textAlign:"center"},children:e.jsx(c,{title:"Targets",value:r?"—":(t==null?void 0:t.targets)??0,prefix:e.jsx(C,{style:{color:"#fa8c16"}}),valueStyle:{color:"#fa8c16",fontWeight:700}})})}),e.jsx(o,{xs:12,sm:6,children:e.jsx(i,{bordered:!1,style:{background:"#fff1f0",borderRadius:10,textAlign:"center"},children:e.jsx(c,{title:"Creds Captured",value:r?"—":(t==null?void 0:t.credsCaptured)??0,prefix:e.jsx(G,{style:{color:"#cf1322"}}),valueStyle:{color:(t==null?void 0:t.credsCaptured)>0?"#cf1322":"#999",fontWeight:700}})})})]}),e.jsx(i,{title:e.jsxs(e.Fragment,{children:[e.jsx(D,{style:{marginRight:8}}),"Recent Campaigns"]}),bordered:!1,style:{borderRadius:10},extra:e.jsx(l,{type:"link",icon:e.jsx(b,{}),onClick:()=>window.open(f,"_blank"),children:"Manage"}),children:!r&&((m=t==null?void 0:t.recent)==null?void 0:m.length)>0?e.jsx(h,{dataSource:t.recent,renderItem:n=>e.jsx(h.Item,{actions:[e.jsx(w,{color:M(n.status),children:n.status.toUpperCase()})],children:e.jsx(h.Item.Meta,{title:n.name,description:new Date(n.created_at).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})})})}):e.jsx("div",{style:{padding:"20px 0",textAlign:"center",color:"#aaa"},children:r?"Loading...":"No campaigns yet"})}),e.jsxs("div",{style:{marginTop:24,textAlign:"center"},children:[e.jsx(l,{type:"primary",size:"large",icon:e.jsx(u,{}),block:!0,style:{background:"#034D57",borderColor:"#034D57",height:48,borderRadius:8,fontSize:16},onClick:()=>window.open(f,"_blank"),children:"Open Full PhishGuard App"}),e.jsx(x,{type:"secondary",style:{display:"block",marginTop:8,fontSize:12},children:"Opens in a new tab · Login with your @alali.om credentials"})]})]}):e.jsx("div",{style:{padding:48,textAlign:"center"},children:e.jsxs(i,{style:{maxWidth:420,margin:"0 auto",borderRadius:12},children:[e.jsx(R,{style:{fontSize:48,color:"#ccc",marginBottom:16}}),e.jsx(v,{level:4,children:"Access Restricted"}),e.jsx(x,{type:"secondary",children:"PhishGuard is available to administrators only. Contact Ali Ghalib or Ali Al Zaabi for access."})]})})}export{Q as default};
