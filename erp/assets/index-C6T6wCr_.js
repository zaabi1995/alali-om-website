import{m as I,r,j as t}from"./index-Bdo9IhP3.js";import{a as T}from"./omrFormat-q8NMaaX9.js";import{d as f}from"./dayjs.min-BYHrLEIb.js";import{ai as i,aA as _,aB as h,ar as F,ay as n}from"./IdurarOs-CcgW1_Xu.js";import{C as g}from"./index-CyTJvvCw.js";import{S as y}from"./index-DgSROa25.js";import{S as P}from"./index-_jee1Xy3.js";import{F as A}from"./Table-BPQS2AiC.js";import{T as L}from"./index-Blr8qKz3.js";import{k as Y,a as $}from"./ErpApp-8OmLeJeH.js";import{P as k}from"./index-DIUcBHA2.js";import{s as E}from"./index-CrqeZkIG.js";import{P as M}from"./PlusOutlined-BjNtlN_I.js";import{D as O}from"./DeleteOutlined-CZPl9_fb.js";import"./Skeleton-DFpyQ2rX.js";import"./index-Bvuzf61M.js";import"./pickAttrs-VDy-1rdS.js";import"./DownOutlined-H-Ukh29_.js";import"./useClosable-D3mZCDnY.js";import"./ActionButton-Vs6gmgp7.js";const{Title:z}=F;function d(){return{Authorization:`Bearer ${localStorage.getItem("x-auth-token")}`}}const j={draft:"default",received:"blue",approved:"cyan",partially_paid:"orange",paid:"green",overdue:"red",cancelled:"default"};function ie(){var u;const l=I(),[S,D]=r.useState([]),[s,b]=r.useState(null),[w,c]=r.useState(!1),[o,v]=r.useState(""),m=async()=>{c(!0);const e=o?`?status=${o}`:"";try{const[a,B]=await Promise.all([fetch(n+`vendorbill/list${e}`,{headers:d()}),fetch(n+"vendorbill/ap-summary",{headers:d()})]),[p,x]=await Promise.all([a.json(),B.json()]);p.success&&D(p.result||[]),x.success&&b(x)}finally{c(!1)}};r.useEffect(()=>{m()},[o]);const C=[{title:"BILL #",dataIndex:"number",width:90,render:(e,a)=>t.jsxs("a",{onClick:()=>l(`/vendor-bill/read/${a._id}`),style:{fontWeight:700,color:"#034D57"},children:["BILL-",e,"/",a.year]})},{title:"Vendor Ref",dataIndex:"vendorRef",width:110},{title:"Vendor",dataIndex:["vendor","companyName"],ellipsis:!0},{title:"Date",dataIndex:"date",width:105,render:e=>f(e).format("DD MMM YYYY")},{title:"Due",dataIndex:"dueDate",width:105,render:e=>e?f(e).format("DD MMM YYYY"):"â€”"},{title:"Total",dataIndex:"total",align:"right",render:(e,a)=>`${parseFloat(e||0).toFixed(3)} ${a.currency}`},{title:"Balance Due",dataIndex:"balanceDue",align:"right",render:(e,a)=>t.jsxs("b",{style:{color:e>0?"#e53e3e":"green"},children:[parseFloat(e||0).toFixed(3)," ",a.currency]})},{title:"Status",dataIndex:"status",width:110,render:e=>t.jsx(L,{color:j[e],children:e==null?void 0:e.replace(/_/g," ").toUpperCase()})},{title:"",width:70,render:(e,a)=>t.jsxs(Y,{children:[t.jsx(i,{size:"small",icon:t.jsx($,{}),onClick:()=>l(`/vendor-bill/read/${a._id}`)}),t.jsx(k,{title:"Delete?",onConfirm:async()=>{await fetch(n+`vendorbill/delete/${a._id}`,{method:"DELETE",headers:d()}),E.success("Deleted"),m()},children:t.jsx(i,{size:"small",danger:!0,icon:t.jsx(O,{})})})]})}];return t.jsxs("div",{style:{padding:24},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[t.jsx(z,{level:4,style:{margin:0,color:"#034D57"},children:"Vendor Bills (Accounts Payable)"}),t.jsx(i,{type:"primary",icon:t.jsx(M,{}),onClick:()=>l("/vendor-bill/create"),style:{background:"#034D57"},children:"New Bill"})]}),s&&s.grandTotal>0&&t.jsxs(_,{gutter:12,style:{marginBottom:16},children:[t.jsx(h,{xs:12,sm:6,children:t.jsx(g,{size:"small",children:t.jsx(y,{title:"Total AP Due",value:parseFloat(s.grandTotal||0).toFixed(3),suffix:T(),valueStyle:{color:"#e53e3e",fontWeight:700}})})}),t.jsx(h,{xs:12,sm:6,children:t.jsx(g,{size:"small",children:t.jsx(y,{title:"Vendors Owing",value:((u=s.result)==null?void 0:u.length)||0})})})]}),t.jsx("div",{style:{marginBottom:12},children:t.jsx(P,{placeholder:"Filter by status",allowClear:!0,style:{width:180},onChange:e=>v(e||""),options:Object.keys(j).map(e=>({value:e,label:e.replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase())}))})}),t.jsx(A,{columns:C,dataSource:S,rowKey:"_id",loading:w,size:"small"})]})}export{ie as default};
