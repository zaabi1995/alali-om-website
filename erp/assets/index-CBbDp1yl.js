import{r as s,m as $,j as r}from"./index-BcNLKCvS.js";import{aA as z,an as B,at as F}from"./IdurarOs-Bnu_4kQ9.js";import{u as G}from"./useDebounce-CdOGnUuZ.js";import{S as l,E as H}from"./index-CHNYwYGg.js";function P({entity:x,displayLabels:b,searchFields:j,outputValue:a="_id",redirectLabel:E="Add New",withRedirect:u=!1,urlToRedirect:O="/",value:t,onChange:n}){const f=B(),h={value:"redirectURL",label:`+ ${f(E)}`},[A,d]=s.useState([]),[y,C]=s.useState(void 0),c=s.useRef(!0),v=s.useRef(!1),[L,o]=s.useState(!1),[S,R]=s.useState(""),[m,N]=s.useState(""),U=$(),q=e=>{c.current=!1,n&&e&&n(e[a]||e),e==="redirectURL"&&u&&U(O)},[,D]=G(()=>{N(S)},500,[S]),T=async e=>await F.search({entity:x,options:e});let{onFetch:k,result:p,isSuccess:g,isLoading:w}=z();const W=e=>b.map(i=>e[i]).join(" ");s.useEffect(()=>{const i=T({q:m,fields:j});return k(i),()=>{D()}},[m]);const _=e=>{v.current=!0,o(!0),R(e)};return s.useEffect(()=>{g?d(p):o(!1)},[g,p]),s.useEffect(()=>{t&&c.current&&(d([t]),C(t[a]||t),n(t[a]||t),c.current=!1)},[t]),r.jsxs(l,{loading:w,showSearch:!0,allowClear:!0,placeholder:f("Search"),defaultActiveFirstOption:!1,filterOption:!1,notFoundContent:L?"... Searching":r.jsx(H,{}),value:y,onSearch:_,onClear:()=>{o(!1)},onChange:q,style:{minWidth:"220px"},children:[A.map(e=>r.jsx(l.Option,{value:e[a]||e,children:W(e)},e[a]||e)),u&&r.jsx(l.Option,{value:h.value,children:h.label})]})}export{P as A};
