import{R as y,r,j as n}from"./index-D-3B17BB.js";import{C as I}from"./index-CPdBGXP_.js";import{j as Be,m as le,U as Z,T as Ie}from"./ErpApp-VqBvRvHh.js";import{a as te,c as _,A as Ne,aC as N,j as Me,m as Le,k as m,r as Ae,n as Re,I as se,o as ce,aB as ge,aD as Te,X as He,b as We,au as Ge,ai as G,al as De,ar as ke}from"./IdurarOs-DIHWZIv9.js";import{A as _e}from"./index-CVLSndJe.js";import{S as D}from"./index-C0UsZ_Vo.js";import{e as Ve,P as Fe}from"./Pagination-CgyH5SNg.js";import{D as Xe}from"./index-DS7PtXKP.js";import{T as Ue}from"./index-DNNlwRee.js";import{R as Je}from"./ReloadOutlined-BdsEjclI.js";import{E as de}from"./ExportOutlined-CA4RR2wM.js";import{W as Ke}from"./WarningOutlined-CHz7i1-R.js";import"./Skeleton-BSS9ySGU.js";import"./index-BGWLHFHo.js";import"./PlusOutlined-D7WCXFFd.js";import"./pickAttrs-3JBImAlU.js";import"./DownOutlined-CMKT2r-s.js";import"./useClosable-DqQmpQFA.js";const ie=y.createContext({});ie.Consumer;var pe=function(e,t){var i={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(i[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(i[a[o]]=e[a[o]]);return i};const qe=e=>{var{prefixCls:t,className:i,avatar:a,title:o,description:l}=e,p=pe(e,["prefixCls","className","avatar","title","description"]);const{getPrefixCls:h}=r.useContext(te),c=h("list",t),$=_(`${c}-item-meta`,i),b=y.createElement("div",{className:`${c}-item-meta-content`},o&&y.createElement("h4",{className:`${c}-item-meta-title`},o),l&&y.createElement("div",{className:`${c}-item-meta-description`},l));return y.createElement("div",Object.assign({},p,{className:$}),a&&y.createElement("div",{className:`${c}-item-meta-avatar`},a),(o||l)&&b)},Ye=(e,t)=>{var{prefixCls:i,children:a,actions:o,extra:l,className:p,colStyle:h}=e,c=pe(e,["prefixCls","children","actions","extra","className","colStyle"]);const{grid:$,itemLayout:b}=r.useContext(ie),{getPrefixCls:z}=r.useContext(te),d=()=>{let S;return r.Children.forEach(a,j=>{typeof j=="string"&&(S=!0)}),S&&r.Children.count(a)>1},E=()=>b==="vertical"?!!l:!d(),u=z("list",i),C=o&&o.length>0&&y.createElement("ul",{className:`${u}-item-action`,key:"actions"},o.map((S,j)=>y.createElement("li",{key:`${u}-item-action-${j}`},S,j!==o.length-1&&y.createElement("em",{className:`${u}-item-action-split`})))),O=$?"div":"li",P=y.createElement(O,Object.assign({},c,$?{}:{ref:t},{className:_(`${u}-item`,{[`${u}-item-no-flex`]:!E()},p)}),b==="vertical"&&l?[y.createElement("div",{className:`${u}-item-main`,key:"content"},a,C),y.createElement("div",{className:`${u}-item-extra`,key:"extra"},l)]:[a,C,Ne(l,{key:"extra"})]);return $?y.createElement(N,{ref:t,flex:1,style:h},P):P},ue=r.forwardRef(Ye);ue.Meta=qe;const Ze=e=>{const{listBorderedCls:t,componentCls:i,paddingLG:a,margin:o,itemPaddingSM:l,itemPaddingLG:p,marginLG:h,borderRadiusLG:c}=e;return{[`${t}`]:{border:`${m(e.lineWidth)} ${e.lineType} ${e.colorBorder}`,borderRadius:c,[`${i}-header,${i}-footer,${i}-item`]:{paddingInline:a},[`${i}-pagination`]:{margin:`${m(o)} ${m(h)}`}},[`${t}${i}-sm`]:{[`${i}-item,${i}-header,${i}-footer`]:{padding:l}},[`${t}${i}-lg`]:{[`${i}-item,${i}-header,${i}-footer`]:{padding:p}}}},Qe=e=>{const{componentCls:t,screenSM:i,screenMD:a,marginLG:o,marginSM:l,margin:p}=e;return{[`@media screen and (max-width:${a}px)`]:{[`${t}`]:{[`${t}-item`]:{[`${t}-item-action`]:{marginInlineStart:o}}},[`${t}-vertical`]:{[`${t}-item`]:{[`${t}-item-extra`]:{marginInlineStart:o}}}},[`@media screen and (max-width: ${i}px)`]:{[`${t}`]:{[`${t}-item`]:{flexWrap:"wrap",[`${t}-action`]:{marginInlineStart:l}}},[`${t}-vertical`]:{[`${t}-item`]:{flexWrap:"wrap-reverse",[`${t}-item-main`]:{minWidth:e.contentWidth},[`${t}-item-extra`]:{margin:`auto auto ${m(p)}`}}}}}},et=e=>{const{componentCls:t,antCls:i,controlHeight:a,minHeight:o,paddingSM:l,marginLG:p,padding:h,itemPadding:c,colorPrimary:$,itemPaddingSM:b,itemPaddingLG:z,paddingXS:d,margin:E,colorText:u,colorTextDescription:C,motionDurationSlow:O,lineWidth:P,headerBg:S,footerBg:j,emptyTextPadding:M,metaMarginBottom:V,avatarMarginRight:L,titleMarginBottom:F,descriptionFontSize:X}=e,A={};return["start","center","end"].forEach(R=>{A[`&-align-${R}`]={textAlign:R}}),{[`${t}`]:Object.assign(Object.assign({},Ae(e)),{position:"relative","*":{outline:"none"},[`${t}-header`]:{background:S},[`${t}-footer`]:{background:j},[`${t}-header, ${t}-footer`]:{paddingBlock:l},[`${t}-pagination`]:Object.assign(Object.assign({marginBlockStart:p},A),{[`${i}-pagination-options`]:{textAlign:"start"}}),[`${t}-spin`]:{minHeight:o,textAlign:"center"},[`${t}-items`]:{margin:0,padding:0,listStyle:"none"},[`${t}-item`]:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:c,color:u,[`${t}-item-meta`]:{display:"flex",flex:1,alignItems:"flex-start",maxWidth:"100%",[`${t}-item-meta-avatar`]:{marginInlineEnd:L},[`${t}-item-meta-content`]:{flex:"1 0",width:0,color:u},[`${t}-item-meta-title`]:{margin:`0 0 ${m(e.marginXXS)} 0`,color:u,fontSize:e.fontSize,lineHeight:e.lineHeight,"> a":{color:u,transition:`all ${O}`,"&:hover":{color:$}}},[`${t}-item-meta-description`]:{color:C,fontSize:X,lineHeight:e.lineHeight}},[`${t}-item-action`]:{flex:"0 0 auto",marginInlineStart:e.marginXXL,padding:0,fontSize:0,listStyle:"none","& > li":{position:"relative",display:"inline-block",padding:`0 ${m(d)}`,color:C,fontSize:e.fontSize,lineHeight:e.lineHeight,textAlign:"center","&:first-child":{paddingInlineStart:0}},[`${t}-item-action-split`]:{position:"absolute",insetBlockStart:"50%",insetInlineEnd:0,width:P,height:e.calc(e.fontHeight).sub(e.calc(e.marginXXS).mul(2)).equal(),transform:"translateY(-50%)",backgroundColor:e.colorSplit}}},[`${t}-empty`]:{padding:`${m(h)} 0`,color:C,fontSize:e.fontSizeSM,textAlign:"center"},[`${t}-empty-text`]:{padding:M,color:e.colorTextDisabled,fontSize:e.fontSize,textAlign:"center"},[`${t}-item-no-flex`]:{display:"block"}}),[`${t}-grid ${i}-col > ${t}-item`]:{display:"block",maxWidth:"100%",marginBlockEnd:E,paddingBlock:0,borderBlockEnd:"none"},[`${t}-vertical ${t}-item`]:{alignItems:"initial",[`${t}-item-main`]:{display:"block",flex:1},[`${t}-item-extra`]:{marginInlineStart:p},[`${t}-item-meta`]:{marginBlockEnd:V,[`${t}-item-meta-title`]:{marginBlockStart:0,marginBlockEnd:F,color:u,fontSize:e.fontSizeLG,lineHeight:e.lineHeightLG}},[`${t}-item-action`]:{marginBlockStart:h,marginInlineStart:"auto","> li":{padding:`0 ${m(h)}`,"&:first-child":{paddingInlineStart:0}}}},[`${t}-split ${t}-item`]:{borderBlockEnd:`${m(e.lineWidth)} ${e.lineType} ${e.colorSplit}`,"&:last-child":{borderBlockEnd:"none"}},[`${t}-split ${t}-header`]:{borderBlockEnd:`${m(e.lineWidth)} ${e.lineType} ${e.colorSplit}`},[`${t}-split${t}-empty ${t}-footer`]:{borderTop:`${m(e.lineWidth)} ${e.lineType} ${e.colorSplit}`},[`${t}-loading ${t}-spin-nested-loading`]:{minHeight:a},[`${t}-split${t}-something-after-last-item ${i}-spin-container > ${t}-items > ${t}-item:last-child`]:{borderBlockEnd:`${m(e.lineWidth)} ${e.lineType} ${e.colorSplit}`},[`${t}-lg ${t}-item`]:{padding:z},[`${t}-sm ${t}-item`]:{padding:b},[`${t}:not(${t}-vertical)`]:{[`${t}-item-no-flex`]:{[`${t}-item-action`]:{float:"right"}}}}},tt=e=>({contentWidth:220,itemPadding:`${m(e.paddingContentVertical)} 0`,itemPaddingSM:`${m(e.paddingContentVerticalSM)} ${m(e.paddingContentHorizontal)}`,itemPaddingLG:`${m(e.paddingContentVerticalLG)} ${m(e.paddingContentHorizontalLG)}`,headerBg:"transparent",footerBg:"transparent",emptyTextPadding:e.padding,metaMarginBottom:e.padding,avatarMarginRight:e.padding,titleMarginBottom:e.paddingSM,descriptionFontSize:e.fontSize}),it=Me("List",e=>{const t=Le(e,{listBorderedCls:`${e.componentCls}-bordered`,minHeight:e.controlHeightLG});return[et(t),Ze(t),Qe(t)]},tt);var nt=function(e,t){var i={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(i[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(i[a[o]]=e[a[o]]);return i};function k(e){var t,{pagination:i=!1,prefixCls:a,bordered:o=!1,split:l=!0,className:p,rootClassName:h,style:c,children:$,itemLayout:b,loadMore:z,grid:d,dataSource:E=[],size:u,header:C,footer:O,loading:P=!1,rowKey:S,renderItem:j,locale:M}=e,V=nt(e,["pagination","prefixCls","bordered","split","className","rootClassName","style","children","itemLayout","loadMore","grid","dataSource","size","header","footer","loading","rowKey","renderItem","locale"]);const L=i&&typeof i=="object"?i:{},[F,X]=r.useState(L.defaultCurrent||1),[A,R]=r.useState(L.defaultPageSize||10),{getPrefixCls:fe,renderEmpty:U,direction:he,list:w}=r.useContext(te),xe={current:1,total:0},ne=s=>(f,v)=>{var Y;X(f),R(v),i&&i[s]&&((Y=i==null?void 0:i[s])===null||Y===void 0||Y.call(i,f,v))},$e=ne("onChange"),ye=ne("onShowSizeChange"),Se=(s,f)=>{if(!j)return null;let v;return typeof S=="function"?v=S(s):S?v=s[S]:v=s.key,v||(v=`list-item-${f}`),r.createElement(r.Fragment,{key:v},j(s,f))},ve=()=>!!(z||i||O),g=fe("list",a),[be,Ce,je]=it(g);let B=P;typeof B=="boolean"&&(B={spinning:B});const J=B&&B.spinning,Ee=Re(u);let T="";switch(Ee){case"large":T="lg";break;case"small":T="sm";break}const Oe=_(g,{[`${g}-vertical`]:b==="vertical",[`${g}-${T}`]:T,[`${g}-split`]:l,[`${g}-bordered`]:o,[`${g}-loading`]:J,[`${g}-grid`]:!!d,[`${g}-something-after-last-item`]:ve(),[`${g}-rtl`]:he==="rtl"},w==null?void 0:w.className,p,h,Ce,je),x=Ve(xe,{total:E.length,current:F,pageSize:A},i||{}),ae=Math.ceil(x.total/x.pageSize);x.current>ae&&(x.current=ae);const re=i?r.createElement("div",{className:_(`${g}-pagination`,`${g}-pagination-align-${(t=x==null?void 0:x.align)!==null&&t!==void 0?t:"end"}`)},r.createElement(Fe,Object.assign({},x,{onChange:$e,onShowSizeChange:ye}))):null;let K=se(E);i&&E.length>(x.current-1)*x.pageSize&&(K=se(E).splice((x.current-1)*x.pageSize,x.pageSize));const ze=Object.keys(d||{}).some(s=>["xs","sm","md","lg","xl","xxl"].includes(s)),oe=Be(ze),H=r.useMemo(()=>{for(let s=0;s<ce.length;s+=1){const f=ce[s];if(oe[f])return f}},[oe]),Pe=r.useMemo(()=>{if(!d)return;const s=H&&d[H]?d[H]:d.column;if(s)return{width:`${100/s}%`,maxWidth:`${100/s}%`}},[d==null?void 0:d.column,H]);let q=J&&r.createElement("div",{style:{minHeight:53}});if(K.length>0){const s=K.map((f,v)=>Se(f,v));q=d?r.createElement(ge,{gutter:d.gutter},r.Children.map(s,f=>r.createElement("div",{key:f==null?void 0:f.key,style:Pe},f))):r.createElement("ul",{className:`${g}-items`},s)}else!$&&!J&&(q=r.createElement("div",{className:`${g}-empty-text`},M&&M.emptyText||(U==null?void 0:U("List"))||r.createElement(Xe,{componentName:"List"})));const W=x.position||"bottom",we=r.useMemo(()=>({grid:d,itemLayout:b}),[JSON.stringify(d),b]);return be(r.createElement(ie.Provider,{value:we},r.createElement("div",Object.assign({style:Object.assign(Object.assign({},w==null?void 0:w.style),c),className:Oe},V),(W==="top"||W==="both")&&re,C&&r.createElement("div",{className:`${g}-header`},C),r.createElement(Te,Object.assign({},B),q,$),O&&r.createElement("div",{className:`${g}-footer`},O),z||(W==="bottom"||W==="both")&&re)))}k.Item=ue;var at={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 305H624V192c0-17.7-14.3-32-32-32H184v-40c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v784c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V640h248v113c0 17.7 14.3 32 32 32h416c17.7 0 32-14.3 32-32V337c0-17.7-14.3-32-32-32zM184 568V232h368v336H184zm656 145H504v-73h112c4.4 0 8-3.6 8-8V377h216v336z"}}]},name:"flag",theme:"outlined"},rt=function(t,i){return r.createElement(He,We({},t,{ref:i,icon:at}))};const ot=r.forwardRef(rt),{Title:me,Text:Q}=ke,lt=["ali.ghalib@alali.om","ali.alzaabi@alali.om"],ee="https://alali.om/phishguard/admin";function st(){var e;try{const t=JSON.parse(localStorage.getItem("auth")||"{}");return lt.includes(((e=t==null?void 0:t.current)==null?void 0:e.email)||"")}catch{return!1}}function ct(e){return e==="active"?"green":e==="completed"?"blue":"default"}function Pt(){var h;const[e,t]=r.useState(null),[i,a]=r.useState(!0),[o,l]=r.useState(!1),p=async()=>{a(!0),l(!1);try{const $=await(await fetch("/phishguard/api/stats/public")).json();$.ok?t($):l(!0)}catch{l(!0)}finally{a(!1)}};return r.useEffect(()=>{p()},[]),st()?n.jsxs("div",{style:{padding:"16px 24px",maxWidth:900,margin:"0 auto"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",flexWrap:"wrap",gap:12,marginBottom:20},children:[n.jsxs(le,{align:"center",children:[n.jsx(Z,{style:{fontSize:28,color:"#034D57"}}),n.jsxs("div",{children:[n.jsx(me,{level:3,style:{margin:0,color:"#034D57"},children:"PhishGuard"}),n.jsx(Q,{type:"secondary",children:"Phishing simulation & employee security awareness"})]})]}),n.jsxs(le,{wrap:!0,children:[n.jsx(G,{icon:n.jsx(Je,{}),onClick:p,loading:i,children:"Refresh"}),n.jsx(G,{type:"primary",icon:n.jsx(de,{}),size:"large",style:{background:"#034D57",borderColor:"#034D57"},onClick:()=>window.open(ee,"_blank"),children:"Open PhishGuard"})]})]}),o&&n.jsx(_e,{type:"warning",message:"Could not load live stats — PhishGuard service may be restarting.",showIcon:!0,style:{marginBottom:16}}),n.jsxs(ge,{gutter:[16,16],style:{marginBottom:20},children:[n.jsx(N,{xs:12,sm:6,children:n.jsx(I,{bordered:!1,style:{background:"#f0f9f6",borderRadius:10,textAlign:"center"},children:n.jsx(D,{title:"Campaigns",value:i?"—":(e==null?void 0:e.campaigns)??0,prefix:n.jsx(ot,{style:{color:"#034D57"}}),valueStyle:{color:"#034D57",fontWeight:700}})})}),n.jsx(N,{xs:12,sm:6,children:n.jsx(I,{bordered:!1,style:{background:"#f6ffed",borderRadius:10,textAlign:"center"},children:n.jsx(D,{title:"Active Now",value:i?"—":(e==null?void 0:e.active)??0,prefix:n.jsx(Z,{style:{color:"#4CB480"}}),valueStyle:{color:"#4CB480",fontWeight:700}})})}),n.jsx(N,{xs:12,sm:6,children:n.jsx(I,{bordered:!1,style:{background:"#fff7e6",borderRadius:10,textAlign:"center"},children:n.jsx(D,{title:"Targets",value:i?"—":(e==null?void 0:e.targets)??0,prefix:n.jsx(Ie,{style:{color:"#fa8c16"}}),valueStyle:{color:"#fa8c16",fontWeight:700}})})}),n.jsx(N,{xs:12,sm:6,children:n.jsx(I,{bordered:!1,style:{background:"#fff1f0",borderRadius:10,textAlign:"center"},children:n.jsx(D,{title:"Creds Captured",value:i?"—":(e==null?void 0:e.credsCaptured)??0,prefix:n.jsx(Ke,{style:{color:"#cf1322"}}),valueStyle:{color:(e==null?void 0:e.credsCaptured)>0?"#cf1322":"#999",fontWeight:700}})})})]}),n.jsx(I,{title:n.jsxs(n.Fragment,{children:[n.jsx(De,{style:{marginRight:8}}),"Recent Campaigns"]}),bordered:!1,style:{borderRadius:10},extra:n.jsx(G,{type:"link",icon:n.jsx(de,{}),onClick:()=>window.open(ee,"_blank"),children:"Manage"}),children:!i&&((h=e==null?void 0:e.recent)==null?void 0:h.length)>0?n.jsx(k,{dataSource:e.recent,renderItem:c=>n.jsx(k.Item,{actions:[n.jsx(Ue,{color:ct(c.status),children:c.status.toUpperCase()})],children:n.jsx(k.Item.Meta,{title:c.name,description:new Date(c.created_at).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})})})}):n.jsx("div",{style:{padding:"20px 0",textAlign:"center",color:"#aaa"},children:i?"Loading...":"No campaigns yet"})}),n.jsxs("div",{style:{marginTop:24,textAlign:"center"},children:[n.jsx(G,{type:"primary",size:"large",icon:n.jsx(Z,{}),block:!0,style:{background:"#034D57",borderColor:"#034D57",height:48,borderRadius:8,fontSize:16},onClick:()=>window.open(ee,"_blank"),children:"Open Full PhishGuard App"}),n.jsx(Q,{type:"secondary",style:{display:"block",marginTop:8,fontSize:12},children:"Opens in a new tab · Login with your @alali.om credentials"})]})]}):n.jsx("div",{style:{padding:48,textAlign:"center"},children:n.jsxs(I,{style:{maxWidth:420,margin:"0 auto",borderRadius:12},children:[n.jsx(Ge,{style:{fontSize:48,color:"#ccc",marginBottom:16}}),n.jsx(me,{level:4,children:"Access Restricted"}),n.jsx(Q,{type:"secondary",children:"PhishGuard is available to administrators only. Contact Ali Ghalib or Ali Al Zaabi for access."})]})})}export{Pt as default};
