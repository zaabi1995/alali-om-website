import{m as j,r,j as t}from"./index-CqiROrvI.js";import{d as y}from"./dayjs.min-C_IV7Sgr.js";import{ai as s,ar as C,ay as c}from"./IdurarOs-U9s3-I7Z.js";import{F as w}from"./Table-B6txZ5Lc.js";import{T as S}from"./index-DAwtC9M-.js";import{h as I,a as D}from"./ErpApp-DC-1NaCs.js";import{P as T}from"./index-fon3fThj.js";import{s as N}from"./index-DGo-z7yc.js";import{P as _}from"./PlusOutlined-CcJquEGz.js";import{D as $}from"./DeleteOutlined-CRGFtP6z.js";import"./pickAttrs-CYJKFN78.js";import"./index-BS7qSh2D.js";import"./DownOutlined-B4TMFaP8.js";import"./useClosable-BJjLAl2J.js";import"./ActionButton-DsbMBcNu.js";const{Title:E}=C;function m(){return{Authorization:`Bearer ${localStorage.getItem("x-auth-token")}`}}function O(i){return`${parseFloat(i||0).toFixed(3)} OMR`}const P={draft:"default",issued:"blue",applied:"green",voided:"red"};function W(){const i=j(),[u,p]=r.useState([]),[f,d]=r.useState(!1),[l,h]=r.useState({page:1,count:0}),o=async(e=1)=>{d(!0);try{const n=await(await fetch(c+`creditnote/list?page=${e}&items=20`,{headers:m()})).json();n.success&&(p(n.result),h(n.pagination||{}))}finally{d(!1)}};r.useEffect(()=>{o(1)},[]);const x=async e=>{await fetch(c+`creditnote/delete/${e}`,{method:"DELETE",headers:m()}),N.success("Deleted"),o(1)},g=[{title:"CN #",dataIndex:"number",width:90,render:(e,a)=>t.jsxs("a",{onClick:()=>i(`/credit-note/read/${a._id}`),style:{fontWeight:700,color:"#e53e3e"},children:["CN-",e,"/",a.year]})},{title:"Client",dataIndex:["client","name"],ellipsis:!0},{title:"Invoice Ref",dataIndex:["invoice"],render:e=>e?`INV-${e.number}/${e.year}`:"â€”",width:110},{title:"Date",dataIndex:"date",render:e=>y(e).format("DD MMM YYYY"),width:110},{title:"Total",dataIndex:"total",align:"right",render:e=>t.jsxs("strong",{style:{color:"#e53e3e"},children:["(",O(e),")"]})},{title:"Status",dataIndex:"status",width:90,render:e=>t.jsx(S,{color:P[e]||"default",children:e==null?void 0:e.toUpperCase()})},{title:"",width:80,render:(e,a)=>t.jsxs(I,{children:[t.jsx(s,{size:"small",icon:t.jsx(D,{}),onClick:()=>i(`/credit-note/read/${a._id}`)}),t.jsx(T,{title:"Delete?",onConfirm:()=>x(a._id),children:t.jsx(s,{size:"small",danger:!0,icon:t.jsx($,{})})})]})}];return t.jsxs("div",{style:{padding:24},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[t.jsx(E,{level:4,style:{margin:0,color:"#e53e3e"},children:"Credit Notes"}),t.jsx(s,{type:"primary",icon:t.jsx(_,{}),onClick:()=>i("/credit-note/create"),danger:!0,children:"New Credit Note"})]}),t.jsx(w,{columns:g,dataSource:u,rowKey:"_id",loading:f,size:"small",pagination:{current:l.page,total:l.count,pageSize:20,onChange:e=>o(e)}})]})}export{W as default};
