import{r as n,m as g,j as t}from"./index-Z1oWpwI1.js";import{o as y}from"./omrFormat-CwRkStV3.js";import{b as j,a as b,C as S,O as w}from"./ErpApp-CAxdkFuJ.js";import{d as v}from"./dayjs.min-Dyk32v85.js";import{X as C,b as I,ay as O,aC as A,aA as s,aB as c,ai as T,ar as z}from"./IdurarOs-fW_xq9ii.js";import{C as d}from"./index-CbsWBcA0.js";import{F as D}from"./Table-lHtZ7w2M.js";import{T as p}from"./index-UqyvOyaF.js";import"./Skeleton-BZzm72Gy.js";import"./index-DvfwOYEh.js";import"./PlusOutlined-CmlJp9in.js";import"./pickAttrs-CZ_DBIBd.js";import"./index-BRWnsjjB.js";import"./DownOutlined-XirTV1B3.js";import"./useClosable-C8Kmz1ZZ.js";var R={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M869 487.8L491.2 159.9c-2.9-2.5-6.6-3.9-10.5-3.9h-88.5c-7.4 0-10.8 9.2-5.2 14l350.2 304H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h585.1L386.9 854c-5.6 4.9-2.2 14 5.2 14h91.5c1.9 0 3.8-.7 5.2-2L869 536.2a32.07 32.07 0 000-48.4z"}}]},name:"arrow-right",theme:"outlined"},k=function(o,l){return n.createElement(C,I({},o,{ref:l,icon:R}))};const B=n.forwardRef(k),{Title:E,Text:J}=z;function F(){return{Authorization:`Bearer ${localStorage.getItem("x-auth-token")}`}}function u(r){return y(r)}function Y({color:r="#4CB480",size:o=28}){return t.jsx("div",{style:{width:o,height:o,borderRadius:"50%",border:`2px solid ${r}`,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:t.jsx(w,{size:o*.42,color:r})})}const m=[{key:"rfqs",label:"Open RFQs",icon:t.jsx(j,{}),color:"#1890ff",desc:"Active procurement requests"},{key:"quotes",label:"Open Quotes",icon:t.jsx(b,{}),color:"#fa8c16",desc:"Quotations pending response"},{key:"invoices",label:"Invoices Due",icon:t.jsx(S,{}),color:"#e53e3e",desc:"Invoices awaiting payment"},{key:"paid",label:"Paid (YTD)",icon:t.jsx(Y,{}),color:"#4CB480",desc:"Total payments received"}];function Z(){const r=g(),[o,l]=n.useState(null),[h,x]=n.useState(!0);if(n.useEffect(()=>{fetch(O+"reports/pipeline",{headers:F()}).then(e=>e.json()).then(e=>{e.success&&l(e.result)}).finally(()=>x(!1))},[]),h)return t.jsx("div",{style:{textAlign:"center",padding:60},children:t.jsx(A,{size:"large"})});const a=(o==null?void 0:o.stages)||{},f=[{title:"Invoice",dataIndex:"number",width:90,render:(e,i)=>t.jsxs("a",{onClick:()=>r(`/invoice/read/${i._id}`),style:{fontWeight:700,color:"#034D57"},children:["INV-",e,"/",i.year]})},{title:"Client",dataIndex:["client","name"],ellipsis:!0},{title:"Date",dataIndex:"date",width:110,render:e=>v(e).format("DD MMM YYYY")},{title:"Amount",dataIndex:"total",align:"right",render:e=>t.jsx("strong",{children:u(e)})},{title:"Status",dataIndex:"status",width:100,render:e=>{const i={draft:"default",pending:"blue",sent:"cyan",received:"orange",cancelled:"red",refund:"purple"};return t.jsx(p,{color:i[e]||"default",children:e==null?void 0:e.toUpperCase()})}},{title:"Payment",dataIndex:"paymentStatus",width:100,render:e=>{const i={unpaid:"red","partially paid":"orange",paid:"green"};return e?t.jsx(p,{color:i[e]||"default",children:e==null?void 0:e.toUpperCase()}):"—"}}];return t.jsxs("div",{style:{padding:"24px"},children:[t.jsx(E,{level:4,style:{color:"#034D57",marginBottom:20},children:"Deal Pipeline"}),t.jsx(s,{gutter:16,style:{marginBottom:28},children:m.map((e,i)=>t.jsx(c,{xs:12,md:6,children:t.jsxs(d,{size:"small",style:{borderTop:`4px solid ${e.color}`,textAlign:"center",position:"relative"},bodyStyle:{padding:"16px 12px"},children:[t.jsx("div",{style:{fontSize:28,color:e.color,marginBottom:6},children:e.icon}),t.jsx("div",{style:{fontSize:28,fontWeight:800,color:"#1a1a1a",lineHeight:1},children:e.key==="paid"?t.jsx("span",{style:{fontSize:16},children:u(a[e.key])}):a[e.key]??"—"}),t.jsx("div",{style:{fontSize:12,fontWeight:600,color:"#034D57",marginTop:4},children:e.label}),t.jsx("div",{style:{fontSize:10,color:"#aaa",marginTop:2},children:e.desc}),i<m.length-1&&t.jsx("div",{style:{position:"absolute",right:-14,top:"50%",transform:"translateY(-50%)",zIndex:1},children:t.jsx(B,{style:{color:"#ccc",fontSize:18}})})]})},e.key))}),t.jsx(s,{gutter:12,style:{marginBottom:20},children:[{label:"View Open RFQs",color:"#1890ff",path:"/rfq?status=new,in_progress"},{label:"View Open Quotes",color:"#fa8c16",path:"/quote"},{label:"Outstanding Invoices",color:"#e53e3e",path:"/invoice"},{label:"Aged Receivables",color:"#034D57",path:"/reports"}].map(e=>t.jsx(c,{xs:12,md:6,children:t.jsx(T,{block:!0,onClick:()=>r(e.path),style:{borderColor:e.color,color:e.color,height:40},children:e.label})},e.label))}),t.jsx(d,{title:"Recent Deals",size:"small",children:t.jsx(D,{columns:f,dataSource:(o==null?void 0:o.recentDeals)||[],rowKey:"_id",size:"small",pagination:{pageSize:10},locale:{emptyText:"No invoices yet"}})})]})}export{Z as default};
