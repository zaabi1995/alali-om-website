import{m as q,r as n,j as t}from"./index-D-3B17BB.js";import{o as v}from"./omrFormat-D2vEQeyW.js";import{aB as y,aC as u,aE as T,ai as j,ar as _,az as B}from"./IdurarOs-DIHWZIv9.js";import{C as w}from"./index-CPdBGXP_.js";import{S as C}from"./index-DS7PtXKP.js";import{F}from"./Table-DFnX_dmh.js";import{T as O}from"./index-DNNlwRee.js";import{R as A}from"./ReloadOutlined-BdsEjclI.js";import"./ErpApp-VqBvRvHh.js";import"./Skeleton-BSS9ySGU.js";import"./index-BGWLHFHo.js";import"./PlusOutlined-D7WCXFFd.js";import"./pickAttrs-3JBImAlU.js";import"./DownOutlined-CMKT2r-s.js";import"./Pagination-CgyH5SNg.js";import"./useClosable-DqQmpQFA.js";function E(){var l,o;try{const d=(o=(l=JSON.parse(localStorage.getItem("auth")||"{}"))==null?void 0:l.current)==null?void 0:o.token;return d?{Authorization:`Bearer ${d}`}:{}}catch{return{}}}const{Title:L,Text:g}=_,{Option:i}=C;function ae(){const l=q(),[o,d]=n.useState([]),[R,x]=n.useState(!0),[c,I]=n.useState({current:1,pageSize:30,total:0}),[p,h]=n.useState(""),[f,P]=n.useState("all"),s=async(e=1,r=p,a=f)=>{x(!0);const N=new URLSearchParams({page:e,items:30,...r&&{fields:"partNumber,nsn,description",q:r},...a!=="all"&&{filter:"status",equal:a}}),m=await(await fetch(B+`part/list?${N}`,{headers:E()})).json();m.success!==!1&&(d(m.result||[]),I(z=>{var S;return{...z,current:e,total:((S=m.pagination)==null?void 0:S.count)||0}})),x(!1)};n.useEffect(()=>{s()},[]);const b={done:"success",pending:"default",researching:"processing",no_results:"warning"},k=[{title:"Part Number",dataIndex:"partNumber",key:"partNumber",width:150,render:e=>t.jsx(g,{strong:!0,style:{color:"#034D57"},children:e||"—"})},{title:"NSN",dataIndex:"nsn",key:"nsn",width:140,render:e=>e?t.jsx(g,{code:!0,style:{fontSize:12},children:e}):"—"},{title:"Description",dataIndex:"description",key:"description",ellipsis:!0,render:e=>e||"—"},{title:"Qty",dataIndex:"quantity",key:"quantity",width:60,align:"center"},{title:"Research",dataIndex:"status",key:"status",width:110,render:e=>t.jsx(O,{color:b[e]||"default",style:{fontSize:11},children:e})},{title:"Sell Price",dataIndex:"unitSellPrice",key:"unitSellPrice",width:110,align:"right",render:(e,r)=>{const a=e||r.unitCostOmr;return a?t.jsx(g,{strong:!0,children:v(a)}):"—"}},{title:"RFQ",dataIndex:["rfq","rfqNumber"],key:"rfq",width:130,render:(e,r)=>{var a;return r.rfq?t.jsx(j,{type:"link",size:"small",style:{padding:0,color:"#034D57",fontSize:12},onClick:()=>l(`/rfq/${r.rfq._id||r.rfq}`),children:e||((a=r.rfq)==null?void 0:a.subject)||"→ View RFQ"}):"—"}}];return t.jsxs("div",{style:{paddingBottom:24},children:[t.jsx(y,{justify:"space-between",align:"middle",style:{marginBottom:16},children:t.jsx(u,{children:t.jsxs(L,{level:4,style:{margin:0,color:"#034D57"},children:["Parts Catalog — ",c.total.toLocaleString()]})})}),t.jsx(w,{style:{marginBottom:16,borderRadius:8},bodyStyle:{padding:"12px 16px"},children:t.jsxs(y,{gutter:[8,8],align:"middle",children:[t.jsx(u,{xs:24,sm:12,md:8,children:t.jsx(T.Search,{placeholder:"Search part #, NSN, description...",value:p,onChange:e=>h(e.target.value),onSearch:e=>{h(e),s(1,e)},allowClear:!0,onClear:()=>{h(""),s(1,"")}})}),t.jsx(u,{xs:12,sm:6,md:4,children:t.jsxs(C,{style:{width:"100%"},value:f,onChange:e=>{P(e),s(1,p,e)},children:[t.jsx(i,{value:"all",children:"All Status"}),t.jsx(i,{value:"done",children:"Researched"}),t.jsx(i,{value:"pending",children:"Pending"}),t.jsx(i,{value:"no_results",children:"No Results"}),t.jsx(i,{value:"researching",children:"In Progress"})]})}),t.jsx(u,{children:t.jsx(j,{icon:t.jsx(A,{}),onClick:()=>s(),children:"Refresh"})})]})}),t.jsx(w,{style:{borderRadius:8},bodyStyle:{padding:0},children:t.jsx("div",{style:{overflowX:"auto"},children:t.jsx(F,{dataSource:o,columns:k,rowKey:"_id",loading:R,size:"small",pagination:{current:c.current,pageSize:c.pageSize,total:c.total,showSizeChanger:!1,showTotal:e=>`${e} parts`,onChange:e=>s(e)}})})})]})}export{ae as default};
