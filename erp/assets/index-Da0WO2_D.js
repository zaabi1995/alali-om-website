import{r as n,j as e}from"./index-B_4eKp3O.js";import{C as s}from"./index-DSpEofHK.js";import{b2 as z,aS as I,aB as o,aM as T,aL as c,aY as O,b5 as A}from"./IdurarOs-DJEruZJs.js";import{S as x}from"./index-BBG8JGQR.js";import{T as m}from"./ErpApp-ByZxq-md.js";import{F as B}from"./Table-BuPp2kFk.js";import{M as D}from"./index-DLWAu19i.js";import{E as h}from"./ExportOutlined-D0t6a5Tc.js";import{C as f}from"./CheckCircleOutlined-tu0O6DVR.js";import"./Skeleton-BZGa1gxJ.js";import"./index-BXo1Csai.js";import"./PlusOutlined-Yh4yKj96.js";import"./ActionButton-CPyo047O.js";import"./fade-DX85EkB_.js";const{Title:y,Text:j}=O,S="https://alali.om/email-signature/auto-login?token=KS351D03ImM-LCGxhC3JSTsjQFWJPCtcBxswpj6yuIU",L=["ali.ghalib@alali.om","ali.alzaabi@alali.om"];function _(){var t;try{const l=JSON.parse(localStorage.getItem("auth")||"{}");return L.includes(((t=l==null?void 0:l.current)==null?void 0:t.email)||"")}catch{return!1}}function V(){const[t,l]=n.useState([]),[u,r]=n.useState(null),[b,v]=n.useState(""),[w,g]=n.useState(!1),C=["ali.ghalib@alali.om","ali.alzaabi@alali.om","milo@alali.om","munawar@alali.om","irfan@alali.om","salim@alali.om","atul@alali.om","aman@alali.om","amanali@alali.om","info@alali.om"],M=async()=>{g(!0);const a=await Promise.all(C.map(async i=>{try{const p=await fetch(`https://alali.om/email-signature/api/signature/${i}`).then(E=>E.json()).catch(()=>({}));return{email:i,found:!!p.found,html:p.html||""}}catch{return{email:i,found:!1,html:""}}}));l(a),g(!1)};if(n.useEffect(()=>{M()},[]),!_())return e.jsx("div",{style:{padding:48,textAlign:"center"},children:e.jsxs(s,{style:{maxWidth:400,margin:"0 auto"},children:[e.jsx(z,{style:{fontSize:48,color:"#ccc",marginBottom:16}}),e.jsx(y,{level:4,children:"Access Restricted"}),e.jsx(j,{type:"secondary",children:"Email Signature Manager is available to administrators only."})]})});const k=[{title:"Email",dataIndex:"email",render:a=>e.jsx(j,{code:!0,style:{fontSize:12},children:a})},{title:"Status",dataIndex:"found",align:"center",render:a=>a?e.jsx(m,{color:"success",icon:e.jsx(f,{}),children:"Active"}):e.jsx(m,{color:"default",children:"No Signature"})},{title:"",align:"right",width:100,render:(a,i)=>i.found&&e.jsx(o,{size:"small",icon:e.jsx(A,{}),onClick:()=>{r(i.html),v(i.email)},children:"Preview"})}],d=t.filter(a=>a.found).length;return e.jsxs("div",{style:{padding:24},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[e.jsx(I,{style:{fontSize:22,color:"#034D57"}}),e.jsx(y,{level:4,style:{margin:0,color:"#034D57"},children:"Email Signature Manager"})]}),e.jsx(o,{type:"primary",icon:e.jsx(h,{}),size:"large",onClick:()=>window.open(S,"_blank"),style:{background:"#034D57",borderColor:"#034D57"},children:"Open Manager"})]}),e.jsxs(T,{gutter:12,style:{marginBottom:20},children:[e.jsx(c,{span:8,children:e.jsx(s,{size:"small",bodyStyle:{padding:"12px 16px"},children:e.jsx(x,{title:"Active Signatures",value:d,valueStyle:{color:"#4CB480"},suffix:`/ ${t.length}`})})}),e.jsx(c,{span:8,children:e.jsx(s,{size:"small",bodyStyle:{padding:"12px 16px"},children:e.jsx(x,{title:"No Signature",value:t.length-d,valueStyle:{color:d<t.length?"#e53e3e":"#888"}})})}),e.jsx(c,{span:8,children:e.jsxs(s,{size:"small",bodyStyle:{padding:"12px 16px"},children:[e.jsx("div",{style:{fontSize:11,color:"#888",marginBottom:4},children:"Filter Status"}),e.jsx(m,{color:"success",icon:e.jsx(f,{}),style:{fontSize:12},children:"Running on port 10024"})]})})]}),e.jsxs("div",{style:{background:"#f0f6f7",border:"1px solid #d0e8eb",borderRadius:8,padding:"12px 16px",marginBottom:16,fontSize:12,color:"#555"},children:[e.jsx("strong",{style:{color:"#034D57"},children:"How it works:"})," Every outgoing email is processed through the signature filter (port 10024). It automatically appends the matching HTML signature + confidentiality disclaimer before delivery. To add or edit signatures, click ",e.jsx("strong",{children:"Open Manager"})," above."]}),e.jsx(B,{columns:k,dataSource:t,rowKey:"email",loading:w,size:"small",pagination:!1}),e.jsx(D,{title:`Signature Preview â€” ${b}`,open:!!u,onCancel:()=>r(null),footer:[e.jsx(o,{onClick:()=>r(null),children:"Close"},"close"),e.jsx(o,{type:"primary",icon:e.jsx(h,{}),onClick:()=>window.open(S,"_blank"),style:{background:"#034D57",borderColor:"#034D57"},children:"Edit in Manager"},"open")],width:700,children:e.jsx("div",{style:{border:"1px solid #e8f0f1",borderRadius:6,padding:16,background:"#fafafa"},children:e.jsx("div",{dangerouslySetInnerHTML:{__html:u}})})})]})}export{V as default};
