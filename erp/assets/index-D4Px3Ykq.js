import{m as A,o as F,r as y,j as e}from"./index-DynqZcYC.js";import{a as d}from"./omrFormat-5vt2WG1V.js";import{d as I}from"./dayjs.min-xbWELxxT.js";import{ay as m,ai as i,aw as O,aA as P,aB as n,ar as R}from"./IdurarOs-DBOvFMl4.js";import{l as D,F as T}from"./ErpApp-Dsj0b1h9.js";import{s as x}from"./index-Bzh2Kr56.js";import{P as k}from"./index-Dlubn56L.js";import{C as o}from"./index-DHi1ZBmO.js";import{S as p}from"./index-i2DxnKCV.js";import{T as b}from"./index-C6iqSUGl.js";import{D as s}from"./index-C1y5wqD9.js";import{A as L}from"./ArrowLeftOutlined-IWIIjw7b.js";import{D as w}from"./DeleteOutlined-Ck3yX7uE.js";import"./ActionButton-CPZSuqlQ.js";import"./Skeleton-CUBT1LVN.js";import"./index-B6m5droV.js";import"./PlusOutlined-DOkyJDj0.js";import"./pickAttrs-BVt-fMi-.js";import"./useClosable-wR5V5ARF.js";const{Title:z}=R;function S(){return{Authorization:`Bearer ${((JSON.parse(localStorage.getItem("auth"))||{}).current||{}).token}`}}const B={draft:"default",approved:"blue",paid:"green",rejected:"red"},M={salaries:"Salaries",rent:"Rent",travel:"Travel",office:"Office Supplies",utilities:"Utilities",bank_charges:"Bank Charges",marketing:"Marketing",maintenance:"Maintenance",insurance:"Insurance",professional_fees:"Professional Fees",customs_duties:"Customs & Duties",shipping:"Shipping",telecommunications:"Telecom",other:"Other"};function ae(){var u,h,f,j;const l=A(),{id:a}=F(),[t,v]=y.useState(null);y.useEffect(()=>{fetch(m+`expense/read/${a}`,{headers:S()}).then(r=>r.json()).then(r=>{r.success&&v(r.result)}).catch(()=>{})},[a]);const C=async()=>{await fetch(m+`expense/delete/${a}`,{method:"DELETE",headers:S()}),x.success("Deleted"),l("/expense")};return t?e.jsxs("div",{style:{padding:24,maxWidth:800},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsxs(D,{children:[e.jsx(i,{icon:e.jsx(L,{}),onClick:()=>l("/expense")}),e.jsxs(z,{level:4,style:{margin:0,color:"#034D57"},children:["EXP-",t.number]})]}),e.jsxs(D,{children:[e.jsx(i,{icon:e.jsx(T,{}),style:{borderColor:"#034D57",color:"#034D57"},onClick:async()=>{try{const r=await fetch(`${m}expense/pdf/${a}`,{headers:{Authorization:`Bearer ${((JSON.parse(localStorage.getItem("auth"))||{}).current||{}).token}`}});if(!r.ok){x.error("Failed to generate PDF");return}const E=await r.blob(),g=URL.createObjectURL(E),c=document.createElement("a");c.href=g,c.download=`EXP-${(t==null?void 0:t.number)||a}.pdf`,c.click(),URL.revokeObjectURL(g)}catch{x.error("PDF download failed")}},children:"Download PDF"}),e.jsx(i,{icon:e.jsx(O,{}),onClick:()=>l(`/expense/edit/${a}`),children:"Edit"}),e.jsx(k,{title:"Delete this expense?",onConfirm:C,children:e.jsx(i,{danger:!0,icon:e.jsx(w,{}),children:"Delete"})})]})]}),e.jsxs(P,{gutter:12,style:{marginBottom:16},children:[e.jsx(n,{xs:12,sm:6,children:e.jsx(o,{size:"small",children:e.jsx(p,{title:"Amount",value:parseFloat(t.amount||0).toFixed(3),suffix:d(),valueStyle:{color:"#034D57"}})})}),e.jsx(n,{xs:12,sm:6,children:e.jsx(o,{size:"small",children:e.jsx(p,{title:"VAT",value:parseFloat(t.taxAmount||0).toFixed(3),suffix:d()})})}),e.jsx(n,{xs:12,sm:6,children:e.jsx(o,{size:"small",children:e.jsx(p,{title:"Total",value:parseFloat(t.total||0).toFixed(3),suffix:d(),valueStyle:{color:"#034D57",fontWeight:700}})})}),e.jsx(n,{xs:12,sm:6,children:e.jsxs(o,{size:"small",style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:12,color:"#888"},children:"Status"}),e.jsx(b,{color:B[t.status],style:{marginTop:6},children:(u=t.status)==null?void 0:u.toUpperCase()})]})})]}),e.jsx(o,{size:"small",children:e.jsxs(s,{column:{xs:1,sm:2},bordered:!0,size:"small",children:[e.jsx(s.Item,{label:"Description",children:t.description}),e.jsx(s.Item,{label:"Category",children:e.jsx(b,{children:M[t.category]||t.category})}),e.jsx(s.Item,{label:"Date",children:I(t.date).format("DD MMM YYYY")}),e.jsx(s.Item,{label:"Payment Method",children:(h=t.paymentMethod)==null?void 0:h.replace(/_/g," ")}),e.jsx(s.Item,{label:"Reference",children:t.reference||"—"}),e.jsx(s.Item,{label:"Vendor",children:((f=t.vendor)==null?void 0:f.companyName)||"—"}),e.jsx(s.Item,{label:"Project",children:((j=t.project)==null?void 0:j.name)||"—"}),t.notes&&e.jsx(s.Item,{label:"Notes",span:2,children:t.notes})]})})]}):e.jsx("div",{style:{padding:24},children:"Loading…"})}export{ae as default};
