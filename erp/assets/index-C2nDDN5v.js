import{m as k,r as s,j as t}from"./index-DynqZcYC.js";import{a as B,o as z}from"./omrFormat-5vt2WG1V.js";import{d as L}from"./dayjs.min-xbWELxxT.js";import{ai as m,aA as M,aB as R,aD as U,aM as Y,ar as $,ay as p}from"./IdurarOs-DBOvFMl4.js";import{C as F}from"./index-DHi1ZBmO.js";import{S as N}from"./index-i2DxnKCV.js";import{l as j,b as X}from"./ErpApp-Dsj0b1h9.js";import{S as C}from"./index-B0MbqwlP.js";import{F as q}from"./Table-CdLo-aJd.js";import{T as w}from"./index-C6iqSUGl.js";import{P as G}from"./index-Dlubn56L.js";import{s as H}from"./index-Bzh2Kr56.js";import{P as J}from"./PlusOutlined-DOkyJDj0.js";import{D as K}from"./DeleteOutlined-Ck3yX7uE.js";import"./Skeleton-CUBT1LVN.js";import"./index-B6m5droV.js";import"./pickAttrs-BVt-fMi-.js";import"./DownOutlined-JFe7GSFF.js";import"./useClosable-wR5V5ARF.js";import"./ActionButton-CPZSuqlQ.js";const{Title:V}=$;function u(){return{Authorization:`Bearer ${((JSON.parse(localStorage.getItem("auth"))||{}).current||{}).token}`}}function W(r){return z(r)}const Q={draft:"default",approved:"blue",paid:"green",rejected:"red"},h={salaries:"Salaries",rent:"Rent",travel:"Travel",office:"Office Supplies",utilities:"Utilities",bank_charges:"Bank Charges",marketing:"Marketing",maintenance:"Maintenance",insurance:"Insurance",professional_fees:"Professional Fees",customs_duties:"Customs & Duties",shipping:"Shipping",telecommunications:"Telecom",other:"Other"};function ye(){var S;const r=k(),[D,E]=s.useState([]),[i,_]=s.useState(null),[P,f]=s.useState(!1),[x,I]=s.useState({page:1,count:0}),[o,T]=s.useState(""),[n,O]=s.useState(""),[l,g]=s.useState(""),d=async(e=1)=>{f(!0);const a=new URLSearchParams({page:e,items:20});o&&a.set("status",o),n&&a.set("category",n),l&&a.set("q",l);try{const[v,A]=await Promise.all([fetch(p+`expense/list?${a}`,{headers:u()}),fetch(p+"expense/summary",{headers:u()})]),[c,y]=await Promise.all([v.json(),A.json()]);c.success&&(E(c.result),I(c.pagination||{})),y.success&&_(y)}finally{f(!1)}};s.useEffect(()=>{d(1)},[o,n,l]);const b=[{title:"EXP #",dataIndex:"number",width:80,render:(e,a)=>t.jsxs("a",{onClick:()=>r(`/expense/read/${a._id}`),style:{fontWeight:700,color:"#034D57"},children:["EXP-",e]})},{title:"Date",dataIndex:"date",width:110,render:e=>L(e).format("DD MMM YYYY")},{title:"Description",dataIndex:"description",ellipsis:!0},{title:"Category",dataIndex:"category",width:130,render:e=>t.jsx(w,{children:h[e]||e})},{title:"Vendor",dataIndex:["vendor","companyName"],render:e=>e||"â€”"},{title:"Amount",dataIndex:"total",align:"right",render:W},{title:"Status",dataIndex:"status",width:90,render:e=>t.jsx(w,{color:Q[e],children:e==null?void 0:e.toUpperCase()})},{title:"",width:70,render:(e,a)=>t.jsxs(j,{children:[t.jsx(m,{size:"small",icon:t.jsx(X,{}),onClick:()=>r(`/expense/read/${a._id}`)}),t.jsx(G,{title:"Delete?",onConfirm:async()=>{await fetch(p+`expense/delete/${a._id}`,{method:"DELETE",headers:u()}),H.success("Deleted"),d(1)},children:t.jsx(m,{size:"small",danger:!0,icon:t.jsx(K,{})})})]})}];return t.jsxs("div",{style:{padding:24},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[t.jsx(V,{level:4,style:{margin:0,color:"#034D57"},children:"Expenses"}),t.jsx(m,{type:"primary",icon:t.jsx(J,{}),onClick:()=>r("/expense/create"),style:{background:"#034D57"},children:"Add Expense"})]}),i&&((S=i.result)==null?void 0:S.length)>0&&t.jsx(M,{gutter:12,style:{marginBottom:16},children:i.result.slice(0,4).map(e=>t.jsx(R,{xs:12,md:6,children:t.jsx(F,{size:"small",children:t.jsx(N,{title:h[e._id]||e._id,value:e.total,precision:3,suffix:B(),valueStyle:{fontSize:14,color:"#034D57"}})})},e._id))}),t.jsxs(j,{style:{marginBottom:12},wrap:!0,children:[t.jsx(U,{placeholder:"Search description...",prefix:t.jsx(Y,{}),allowClear:!0,style:{width:220},onPressEnter:e=>g(e.target.value),onChange:e=>!e.target.value&&g("")}),t.jsx(C,{placeholder:"Category",allowClear:!0,style:{width:160},onChange:e=>O(e||""),options:Object.entries(h).map(([e,a])=>({value:e,label:a}))}),t.jsx(C,{placeholder:"Status",allowClear:!0,style:{width:130},onChange:e=>T(e||""),options:["draft","approved","paid","rejected"].map(e=>({value:e,label:e.charAt(0).toUpperCase()+e.slice(1)}))})]}),t.jsx(q,{columns:b,dataSource:D,rowKey:"_id",loading:P,size:"small",pagination:{current:x.page,total:x.count,pageSize:20,onChange:e=>d(e)}})]})}export{ye as default};
