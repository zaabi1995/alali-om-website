import{r as o,j as e}from"./index-D-3B17BB.js";import{C as n}from"./index-CPdBGXP_.js";import{au as z,al as I,ai as r,aB as T,aC as c,ar as O,ax as A}from"./IdurarOs-DIHWZIv9.js";import{S as x}from"./index-C0UsZ_Vo.js";import{T as m}from"./index-DNNlwRee.js";import{F as B}from"./Table-DFnX_dmh.js";import{M as D}from"./index-CKFIXt4d.js";import{E as h}from"./ExportOutlined-CA4RR2wM.js";import{C as f}from"./CheckCircleOutlined-C3oZh2gc.js";import"./Skeleton-BSS9ySGU.js";import"./index-BGWLHFHo.js";import"./ErpApp-VqBvRvHh.js";import"./PlusOutlined-D7WCXFFd.js";import"./pickAttrs-3JBImAlU.js";import"./useClosable-DqQmpQFA.js";import"./index-DS7PtXKP.js";import"./DownOutlined-CMKT2r-s.js";import"./Pagination-CgyH5SNg.js";import"./ActionButton-CIjC0KcO.js";import"./fade-OTWdHE2v.js";const{Title:y,Text:j}=O,S="https://alali.om/email-signature/auto-login?token=KS351D03ImM-LCGxhC3JSTsjQFWJPCtcBxswpj6yuIU",_=["ali.ghalib@alali.om","ali.alzaabi@alali.om"];function L(){var t;try{const l=JSON.parse(localStorage.getItem("auth")||"{}");return _.includes(((t=l==null?void 0:l.current)==null?void 0:t.email)||"")}catch{return!1}}function ae(){const[t,l]=o.useState([]),[u,s]=o.useState(null),[v,b]=o.useState(""),[w,p]=o.useState(!1),C=["ali.ghalib@alali.om","ali.alzaabi@alali.om","milo@alali.om","munawar@alali.om","irfan@alali.om","salim@alali.om","atul@alali.om","aman@alali.om","amanali@alali.om","info@alali.om"],M=async()=>{p(!0);const i=await Promise.all(C.map(async a=>{try{const g=await fetch(`https://alali.om/email-signature/api/signature/${a}`).then(E=>E.json()).catch(()=>({}));return{email:a,found:!!g.found,html:g.html||""}}catch{return{email:a,found:!1,html:""}}}));l(i),p(!1)};if(o.useEffect(()=>{M()},[]),!L())return e.jsx("div",{style:{padding:48,textAlign:"center"},children:e.jsxs(n,{style:{maxWidth:400,margin:"0 auto"},children:[e.jsx(z,{style:{fontSize:48,color:"#ccc",marginBottom:16}}),e.jsx(y,{level:4,children:"Access Restricted"}),e.jsx(j,{type:"secondary",children:"Email Signature Manager is available to administrators only."})]})});const k=[{title:"Email",dataIndex:"email",render:i=>e.jsx(j,{code:!0,style:{fontSize:12},children:i})},{title:"Status",dataIndex:"found",align:"center",render:i=>i?e.jsx(m,{color:"success",icon:e.jsx(f,{}),children:"Active"}):e.jsx(m,{color:"default",children:"No Signature"})},{title:"",align:"right",width:100,render:(i,a)=>a.found&&e.jsx(r,{size:"small",icon:e.jsx(A,{}),onClick:()=>{s(a.html),b(a.email)},children:"Preview"})}],d=t.filter(i=>i.found).length;return e.jsxs("div",{style:{padding:24},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[e.jsx(I,{style:{fontSize:22,color:"#034D57"}}),e.jsx(y,{level:4,style:{margin:0,color:"#034D57"},children:"Email Signature Manager"})]}),e.jsx(r,{type:"primary",icon:e.jsx(h,{}),size:"large",onClick:()=>window.open(S,"_blank"),style:{background:"#034D57",borderColor:"#034D57"},children:"Open Manager"})]}),e.jsxs(T,{gutter:12,style:{marginBottom:20},children:[e.jsx(c,{span:8,children:e.jsx(n,{size:"small",bodyStyle:{padding:"12px 16px"},children:e.jsx(x,{title:"Active Signatures",value:d,valueStyle:{color:"#4CB480"},suffix:`/ ${t.length}`})})}),e.jsx(c,{span:8,children:e.jsx(n,{size:"small",bodyStyle:{padding:"12px 16px"},children:e.jsx(x,{title:"No Signature",value:t.length-d,valueStyle:{color:d<t.length?"#e53e3e":"#888"}})})}),e.jsx(c,{span:8,children:e.jsxs(n,{size:"small",bodyStyle:{padding:"12px 16px"},children:[e.jsx("div",{style:{fontSize:11,color:"#888",marginBottom:4},children:"Filter Status"}),e.jsx(m,{color:"success",icon:e.jsx(f,{}),style:{fontSize:12},children:"Running on port 10024"})]})})]}),e.jsxs("div",{style:{background:"#f0f6f7",border:"1px solid #d0e8eb",borderRadius:8,padding:"12px 16px",marginBottom:16,fontSize:12,color:"#555"},children:[e.jsx("strong",{style:{color:"#034D57"},children:"How it works:"})," Every outgoing email is processed through the signature filter (port 10024). It automatically appends the matching HTML signature + confidentiality disclaimer before delivery. To add or edit signatures, click ",e.jsx("strong",{children:"Open Manager"})," above."]}),e.jsx(B,{columns:k,dataSource:t,rowKey:"email",loading:w,size:"small",pagination:!1}),e.jsx(D,{title:`Signature Preview â€” ${v}`,open:!!u,onCancel:()=>s(null),footer:[e.jsx(r,{onClick:()=>s(null),children:"Close"},"close"),e.jsx(r,{type:"primary",icon:e.jsx(h,{}),onClick:()=>window.open(S,"_blank"),style:{background:"#034D57",borderColor:"#034D57"},children:"Edit in Manager"},"open")],width:700,children:e.jsx("div",{style:{border:"1px solid #e8f0f1",borderRadius:6,padding:16,background:"#fafafa"},children:e.jsx("div",{dangerouslySetInnerHTML:{__html:u}})})})]})}export{ae as default};
