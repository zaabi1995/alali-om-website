import{m as j,r as i,j as t}from"./index-CB_AWKJY.js";import{o as y}from"./omrFormat-CTBUnK1w.js";import{d as C}from"./dayjs.min-rDaZbkwJ.js";import{aB as o,aY as S,aV as c}from"./IdurarOs-20-QWMXR.js";import{F as w}from"./Table-r_Zm9lDt.js";import{T as I,l as T,c as D,k as N}from"./ErpApp-Cy5crc22.js";import{P as _}from"./index-CcsZN35Z.js";import{s as E}from"./index-CvT_fNtU.js";import{P as $}from"./PlusOutlined-YO2bg1HW.js";import"./ActionButton-CQP3RUHL.js";const{Title:O}=S;function u(){return{Authorization:`Bearer ${((JSON.parse(localStorage.getItem("auth"))||{}).current||{}).token}`}}function P(r){return y(r)}const b={draft:"default",issued:"blue",applied:"green",voided:"red"};function V(){const r=j(),[m,p]=i.useState([]),[f,d]=i.useState(!1),[l,g]=i.useState({page:1,count:0}),n=async(e=1)=>{d(!0);try{const s=await(await fetch(c+`creditnote/list?page=${e}&items=20`,{headers:u()})).json();s.success&&(p(s.result),g(s.pagination||{}))}finally{d(!1)}};i.useEffect(()=>{n(1)},[]);const h=async e=>{await fetch(c+`creditnote/delete/${e}`,{method:"DELETE",headers:u()}),E.success("Deleted"),n(1)},x=[{title:"CN #",dataIndex:"number",width:90,render:(e,a)=>t.jsxs("a",{onClick:()=>r(`/credit-note/read/${a._id}`),style:{fontWeight:700,color:"#e53e3e"},children:["CN-",e,"/",a.year]})},{title:"Client",dataIndex:["client","name"],ellipsis:!0},{title:"Invoice Ref",dataIndex:["invoice"],render:e=>e?`INV-${e.number}/${e.year}`:"â€”",width:110},{title:"Date",dataIndex:"date",render:e=>C(e).format("DD MMM YYYY"),width:110},{title:"Total",dataIndex:"total",align:"right",render:e=>t.jsxs("strong",{style:{color:"#e53e3e"},children:["(",P(e),")"]})},{title:"Status",dataIndex:"status",width:90,render:e=>t.jsx(I,{color:b[e]||"default",children:e==null?void 0:e.toUpperCase()})},{title:"",width:80,render:(e,a)=>t.jsxs(T,{children:[t.jsx(o,{size:"small",icon:t.jsx(D,{}),onClick:()=>r(`/credit-note/read/${a._id}`)}),t.jsx(_,{title:"Delete?",onConfirm:()=>h(a._id),children:t.jsx(o,{size:"small",danger:!0,icon:t.jsx(N,{})})})]})}];return t.jsxs("div",{style:{padding:24},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[t.jsx(O,{level:4,style:{margin:0,color:"#e53e3e"},children:"Credit Notes"}),t.jsx(o,{type:"primary",icon:t.jsx($,{}),onClick:()=>r("/credit-note/create"),danger:!0,children:"New Credit Note"})]}),t.jsx(w,{columns:x,dataSource:m,rowKey:"_id",loading:f,size:"small",pagination:{current:l.page,total:l.count,pageSize:20,onChange:e=>n(e)}})]})}export{V as default};
