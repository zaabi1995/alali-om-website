import{r as a,j as e}from"./index-P0d3qDOI.js";import{o as A}from"./omrFormat-DsLViM07.js";import{aM as C,aL as c,aY as I,aV as O}from"./IdurarOs-C9Hfvmhw.js";import{d as k}from"./dayjs.min-JkzBIzl3.js";import{r as T}from"./relativeTime-B4U_lm-Q.js";import{A as R}from"./index-lSvV4oKT.js";import{C as n}from"./index-D7ycNofp.js";import{S as d}from"./index-B9Siwb96.js";import{F as B}from"./Table-cLwJzRkI.js";import{C as u,T as o,x as N}from"./ErpApp-DhsEC5_U.js";import{W as x}from"./WarningOutlined-BhgFwH10.js";import{A as f}from"./AlertOutlined-npxJ7heO.js";import"./Skeleton-HlVWT2JN.js";import"./index-uRPskGn0.js";import"./PlusOutlined-7jHXhlhV.js";k.extend(T);const{Title:E}=I;function L(){return{Authorization:`Bearer ${((JSON.parse(localStorage.getItem("auth"))||{}).current||{}).token}`}}function F(s){return A(s)}function Z(){const[s,p]=a.useState([]),[m,g]=a.useState(!1),[h,j]=a.useState({critical:0,high:0,medium:0}),y=async()=>{g(!0);try{const t=await(await fetch(O+"inventoryitem/reorder-alerts",{headers:L()})).json();if(t.success){p(t.result||[]);const i=t.result.filter(l=>l.severity==="critical").length,w=t.result.filter(l=>l.severity==="high").length,b=t.result.filter(l=>l.severity==="medium").length;j({critical:i,high:w,medium:b})}}finally{g(!1)}};a.useEffect(()=>{y()},[]);const v=r=>r==="critical"?"red":r==="high"?"orange":"yellow",S=[{title:"Severity",dataIndex:"severity",width:100,render:r=>e.jsx(o,{color:v(r),icon:e.jsx(x,{}),children:r.toUpperCase()}),sorter:(r,t)=>{const i={critical:3,high:2,medium:1};return(i[t.severity]||0)-(i[r.severity]||0)},defaultSortOrder:"ascend"},{title:"Part Number",dataIndex:"partNumber",render:r=>e.jsx("strong",{children:r}),width:140},{title:"Description",dataIndex:"description",ellipsis:!0},{title:"Available Stock",dataIndex:"qtyAvailable",align:"center",width:120,render:r=>e.jsx(N,{count:r,showZero:!0,style:{backgroundColor:r===0?"#e53e3e":"#f59e0b"}})},{title:"Reorder Level",dataIndex:"reorderLevel",align:"center",width:120,render:r=>e.jsx(o,{color:"blue",children:r})},{title:"Max Stock",dataIndex:"maxStock",align:"center",width:100,render:r=>r>0?r:"â€”"},{title:"Suggested Order Qty",dataIndex:"suggestedOrderQty",align:"center",width:150,render:r=>e.jsx("strong",{style:{color:"#4CB480",fontSize:"16px"},children:r})},{title:"Est. Cost",dataIndex:"unitCost",align:"right",width:120,render:(r,t)=>{const i=r*t.suggestedOrderQty;return F(i)}},{title:"Stockout Forecast",dataIndex:"daysUntilStockout",width:150,render:(r,t)=>t.qtyAvailable===0?e.jsx(o,{color:"red",icon:e.jsx(f,{}),children:"OUT OF STOCK"}):r===null?e.jsx("span",{style:{color:"#999"},children:"No data"}):r<=7?e.jsxs(o,{color:"red",icon:e.jsx(u,{}),children:[r," days"]}):r<=30?e.jsxs(o,{color:"orange",icon:e.jsx(u,{}),children:[r," days"]}):e.jsxs(o,{color:"green",icon:e.jsx(u,{}),children:[r," days"]})}];return e.jsxs("div",{style:{padding:"24px"},children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsxs(E,{level:3,children:[e.jsx(x,{style:{color:"#f59e0b",marginRight:"8px"}}),"Inventory Reorder Alerts"]})}),s.length===0&&!m?e.jsx(R,{message:"No Reorder Alerts",description:"All inventory items are above their reorder levels. Great job!",type:"success",showIcon:!0,style:{marginBottom:"24px"}}):e.jsxs(C,{gutter:16,style:{marginBottom:"24px"},children:[e.jsx(c,{span:6,children:e.jsx(n,{children:e.jsx(d,{title:"Total Alerts",value:s.length,valueStyle:{color:"#f59e0b"},prefix:e.jsx(x,{})})})}),e.jsx(c,{span:6,children:e.jsx(n,{children:e.jsx(d,{title:"Critical (Out of Stock)",value:h.critical,valueStyle:{color:"#e53e3e"},prefix:e.jsx(f,{})})})}),e.jsx(c,{span:6,children:e.jsx(n,{children:e.jsx(d,{title:"High Priority",value:h.high,valueStyle:{color:"#f59e0b"},prefix:e.jsx(x,{})})})}),e.jsx(c,{span:6,children:e.jsx(n,{children:e.jsx(d,{title:"Medium Priority",value:h.medium,valueStyle:{color:"#fbbf24"},prefix:e.jsx(u,{})})})})]}),e.jsx(n,{children:e.jsx(B,{columns:S,dataSource:s,loading:m,rowKey:"_id",pagination:{pageSize:20},rowClassName:r=>r.severity==="critical"?"row-critical":r.severity==="high"?"row-high":""})}),e.jsx("style",{jsx:!0,children:`
        .row-critical {
          background-color: #fee;
        }
        .row-high {
          background-color: #fff3e0;
        }
      `})]})}export{Z as default};
