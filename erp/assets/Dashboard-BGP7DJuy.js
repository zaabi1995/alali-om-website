import{r as u,j as e,m as B,n as N,u as k}from"./index-ZLb2J4fw.js";import{u as R}from"./useMoney-rQeODoOH.js";import{D as P,E as U,s as I,F as Q,T as V}from"./ErpApp-CpB8_dmX.js";import{X as $,b as A,au as W,av as q,al as K,aw as X,as as E,ax as Z,ay as C,az as D,aA as b,aq as G,aB as M}from"./IdurarOs-SjSzUutW.js";import{u as J}from"./useFetch-bmizDhtP.js";import{e as T}from"./actions-CuZbroYw.js";import{F as Y}from"./FilePdfOutlined-BCzOstHK.js";import{F as ee}from"./Table-DPzjT9ig.js";import{S as te}from"./SyncOutlined-CLSeul7-.js";import{C as ae}from"./CheckCircleOutlined-B1afZ3jQ.js";import{C as _}from"./index-D5kGrzlF.js";import"./pickAttrs-CkwYu8bF.js";import"./index-CX34Vwxd.js";import"./DownOutlined-D1AlrGPB.js";import"./Skeleton-Wg1VX6xv.js";import"./index-CT8M6ocs.js";import"./PlusOutlined-CiY77jmX.js";var ie={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M193 796c0 17.7 14.3 32 32 32h574c17.7 0 32-14.3 32-32V563c0-176.2-142.8-319-319-319S193 386.8 193 563v233zm72-233c0-136.4 110.6-247 247-247s247 110.6 247 247v193H404V585c0-5.5-4.5-10-10-10h-44c-5.5 0-10 4.5-10 10v171h-75V563zm-48.1-252.5l39.6-39.6c3.1-3.1 3.1-8.2 0-11.3l-67.9-67.9a8.03 8.03 0 00-11.3 0l-39.6 39.6a8.03 8.03 0 000 11.3l67.9 67.9c3.1 3.1 8.1 3.1 11.3 0zm669.6-79.2l-39.6-39.6a8.03 8.03 0 00-11.3 0l-67.9 67.9a8.03 8.03 0 000 11.3l39.6 39.6c3.1 3.1 8.2 3.1 11.3 0l67.9-67.9c3.1-3.2 3.1-8.2 0-11.3zM832 892H192c-17.7 0-32 14.3-32 32v24c0 4.4 3.6 8 8 8h688c4.4 0 8-3.6 8-8v-24c0-17.7-14.3-32-32-32zM484 180h56c4.4 0 8-3.6 8-8V76c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v96c0 4.4 3.6 8 8 8z"}}]},name:"alert",theme:"outlined"},se=function(a,t){return u.createElement($,A({},a,{ref:t,icon:ie}))};const ne=u.forwardRef(se);var oe={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M922.9 701.9H327.4l29.9-60.9 496.8-.9c16.8 0 31.2-12 34.2-28.6l68.8-385.1c1.8-10.1-.9-20.5-7.5-28.4a34.99 34.99 0 00-26.6-12.5l-632-2.1-5.4-25.4c-3.4-16.2-18-28-34.6-28H96.5a35.3 35.3 0 100 70.6h125.9L246 312.8l58.1 281.3-74.8 122.1a34.96 34.96 0 00-3 36.8c6 11.9 18.1 19.4 31.5 19.4h62.8a102.43 102.43 0 00-20.6 61.7c0 56.6 46 102.6 102.6 102.6s102.6-46 102.6-102.6c0-22.3-7.4-44-20.6-61.7h161.1a102.43 102.43 0 00-20.6 61.7c0 56.6 46 102.6 102.6 102.6s102.6-46 102.6-102.6c0-22.3-7.4-44-20.6-61.7H923c19.4 0 35.3-15.8 35.3-35.3a35.42 35.42 0 00-35.4-35.2zM305.7 253l575.8 1.9-56.4 315.8-452.3.8L305.7 253zm96.9 612.7c-17.4 0-31.6-14.2-31.6-31.6 0-17.4 14.2-31.6 31.6-31.6s31.6 14.2 31.6 31.6a31.6 31.6 0 01-31.6 31.6zm325.1 0c-17.4 0-31.6-14.2-31.6-31.6 0-17.4 14.2-31.6 31.6-31.6s31.6 14.2 31.6 31.6a31.6 31.6 0 01-31.6 31.6z"}}]},name:"shopping-cart",theme:"outlined"},le=function(a,t){return u.createElement($,A({},a,{ref:t,icon:oe}))};const re=u.forwardRef(le);function F({...i}){const a=K();let{entity:t,dataTableColumns:o}=i;const s=[{label:a("Show"),key:"read",icon:e.jsx(W,{})},{label:a("Edit"),key:"edit",icon:e.jsx(q,{})},{label:a("Download"),key:"download",icon:e.jsx(Y,{})}],c=B(),r=N(),d=l=>{r(T.currentItem({data:l})),c(`/${t}/read/${l._id}`)},f=l=>{r(T.currentAction({actionType:"update",data:l})),c(`/${t}/update/${l._id}`)},S=l=>{window.open(`${X}${t}/${t}-${l._id}.pdf`,"_blank")};o=[...o,{title:"",key:"action",render:(l,h)=>e.jsx(P,{menu:{items:s,onClick:({key:x})=>{switch(x){case"read":d(h);break;case"edit":f(h);break;case"download":S(h);break}}},trigger:["click"],children:e.jsx(U,{style:{cursor:"pointer",fontSize:"24px"},onClick:x=>x.preventDefault()})})}];const g=()=>E.list({entity:t}),{result:y,isLoading:w,isSuccess:m}=J(g),z=()=>m&&y?y.slice(0,5):[];return e.jsx(ee,{columns:o,rowKey:l=>l._id,dataSource:m&&z(),pagination:!1,loading:w,scroll:{x:!0}})}const ce="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3csvg%20id='Layer_1'%20data-name='Layer%201'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20741.36%20415.06'%3e%3cg%20id='RHhDp6'%3e%3cpath%20d='M259.9,219.89c-.63-49.2,11.44-95.41,35.76-137.75C331.7,19.4,371.24-.36,439.78,34.99c10.67,5.5,53.6,35.43,57.81,44.54,5.03,10.87-27.48,103.87-29.11,122.3-34.69-37.51-99.37-98.66-154.85-69.62-45.05,23.58-12.02,62.54,11.46,87.68h406.25l-39.14,70.23-289.2-2c-1.11,4.66.87,3.3,2.53,4.6,12.44,9.72,80.97,31.54,94.75,31.54l172.05,1.99-39.49,71.25H10.03l39.24-71.24h272.14l-37.11-36.13H69.33l39.23-70.23h151.33Z'/%3e%3c/g%3e%3c/svg%3e";function H({size:i=14,color:a="currentColor",style:t={},className:o=""}){return e.jsx("img",{src:ce,alt:"OMR",className:o,style:{width:i*1.8,height:i,display:"inline-block",verticalAlign:"middle",filter:a==="currentColor"?"brightness(0)":"brightness(0) saturate(0)",opacity:1,...t}})}const{Title:j,Text:Te}=G;function de(){return{Authorization:`Bearer ${localStorage.getItem("x-auth-token")}`}}function p({icon:i,label:a,value:t,color:o,subtitle:s,loading:c,onClick:r}){return e.jsx(b,{xs:12,sm:8,md:6,lg:4,children:e.jsxs(_,{onClick:r,style:{borderRadius:10,border:`1px solid ${o}22`,cursor:r?"pointer":"default",transition:"box-shadow 0.2s"},bodyStyle:{padding:"14px 12px",textAlign:"center"},hoverable:!!r,children:[e.jsx("div",{style:{fontSize:24,color:o,marginBottom:4},children:i}),c?e.jsx(M,{size:"small"}):e.jsx("div",{style:{fontSize:24,fontWeight:800,color:"#034D57",lineHeight:1},children:(t==null?void 0:t.toLocaleString())??"â€”"}),e.jsx("div",{style:{fontSize:12,color:"#555",marginTop:3,fontWeight:600},children:a}),s&&e.jsx("div",{style:{fontSize:11,color:"#aaa",marginTop:1},children:s})]})})}function v({title:i,value:a,subtitle:t,loading:o,color:s="#034D57"}){R(),k(I);const c=!o&&a!==void 0?Number(a||0).toLocaleString("en-US",{minimumFractionDigits:3,maximumFractionDigits:3}):null;return e.jsx(b,{xs:12,sm:12,md:6,lg:6,children:e.jsxs(_,{style:{borderRadius:10,borderLeft:`3px solid ${s}`},bodyStyle:{padding:"14px 16px"},children:[e.jsx("div",{style:{fontSize:12,color:"#888",fontWeight:600,marginBottom:6},children:i}),o?e.jsx(M,{size:"small"}):e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:7},children:[e.jsx(H,{size:14,style:{filter:"brightness(0) saturate(100%) invert(20%) sepia(60%) saturate(400%) hue-rotate(160deg)"}}),e.jsx("span",{style:{fontSize:20,fontWeight:800,color:s,fontVariantNumeric:"tabular-nums"},children:c??"0.000"})]}),e.jsx("div",{style:{fontSize:11,color:"#aaa",marginTop:2},children:t})]})})}function ue(){var x,O;R();const i=B(),a=k(I),[t,o]=u.useState(null),[s,c]=u.useState(!0);u.useEffect(()=>{fetch(Z+"rfq/stats",{headers:de()}).then(n=>n.json()).then(n=>{n.success&&o(n.result)}).catch(()=>{}).finally(()=>c(!1))},[]);const r=async({entity:n,currency:L})=>E.summary({entity:n,options:{currency:L}}),{result:d,isLoading:f,onFetch:S}=C(),{result:g,isLoading:y,onFetch:w}=C(),{result:m,isLoading:z,onFetch:l}=C();u.useEffect(()=>{const n=(a==null?void 0:a.default_currency_code)||"OMR";S(r({entity:"invoice",currency:n})),w(r({entity:"quote",currency:n})),l(r({entity:"payment",currency:n}))},[a==null?void 0:a.default_currency_code]);const h=[{title:"#",dataIndex:"number",width:70},{title:"Client",dataIndex:["client","name"],ellipsis:!0},{title:"Total",dataIndex:"total",align:"right",render:(n,L)=>e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:4,fontSize:12},children:[e.jsx(H,{size:10}),Number(n||0).toLocaleString("en-US",{minimumFractionDigits:3})]})},{title:"Status",dataIndex:"status",width:90,render:n=>e.jsx("span",{style:{fontSize:12,textTransform:"capitalize"},children:n})}];return a?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{marginBottom:6},children:[e.jsx(j,{level:5,style:{color:"#034D57",textTransform:"uppercase",fontSize:12,letterSpacing:1.5,marginBottom:12},children:"Procurement"}),e.jsxs(D,{gutter:[12,12],children:[e.jsx(p,{icon:e.jsx(Q,{}),label:"Total RFQs",value:t==null?void 0:t.total,color:"#034D57",loading:s,onClick:()=>i("/rfq")}),e.jsx(p,{icon:e.jsx(te,{}),label:"Active",value:t==null?void 0:t.active,color:"#1890ff",subtitle:"open RFQs",loading:s,onClick:()=>i("/rfq?status=new,in_progress,researched")}),e.jsx(p,{icon:e.jsx(ne,{}),label:"IOR",value:(x=t==null?void 0:t.byPriority)==null?void 0:x.ior,color:"#ff4d4f",subtitle:"priority",loading:s,onClick:()=>i("/rfq?priority=ior")}),e.jsx(p,{icon:e.jsx(ae,{}),label:"Quoted",value:(O=t==null?void 0:t.byStatus)==null?void 0:O.quoted,color:"#52c41a",loading:s,onClick:()=>i("/rfq?status=quoted")}),e.jsx(p,{icon:e.jsx(V,{}),label:"Suppliers",value:t==null?void 0:t.totalVendors,color:"#4CB480",loading:s,onClick:()=>i("/suppliers")}),e.jsx(p,{icon:e.jsx(re,{}),label:"Parts",value:t==null?void 0:t.totalParts,color:"#722ed1",loading:s,onClick:()=>i("/parts")})]})]}),e.jsx("div",{className:"space20"}),e.jsxs("div",{style:{marginBottom:6},children:[e.jsx(j,{level:5,style:{color:"#034D57",textTransform:"uppercase",fontSize:12,letterSpacing:1.5,marginBottom:12},children:"Financial Summary"}),e.jsxs(D,{gutter:[12,12],children:[e.jsx(v,{title:"Invoices This Month",value:d==null?void 0:d.total,loading:f,color:"#034D57",subtitle:"billed"}),e.jsx(v,{title:"Quotes This Month",value:g==null?void 0:g.total,loading:y,color:"#1890ff",subtitle:"proposed"}),e.jsx(v,{title:"Received Payments",value:m==null?void 0:m.total,loading:z,color:"#52c41a",subtitle:"this month"}),e.jsx(v,{title:"Unpaid Balance",value:d==null?void 0:d.total_undue,loading:f,color:"#ff4d4f",subtitle:"outstanding"})]})]}),e.jsx("div",{className:"space30"}),e.jsxs(D,{gutter:[16,16],children:[e.jsx(b,{xs:24,lg:12,children:e.jsxs("div",{className:"whiteBox shadow pad20",style:{borderRadius:8},children:[e.jsx(j,{level:5,style:{color:"#034D57",marginBottom:12},children:"Recent Invoices"}),e.jsx(F,{entity:"invoice",dataTableColumns:h})]})}),e.jsx(b,{xs:24,lg:12,children:e.jsxs("div",{className:"whiteBox shadow pad20",style:{borderRadius:8},children:[e.jsx(j,{level:5,style:{color:"#034D57",marginBottom:12},children:"Recent Quotes"}),e.jsx(F,{entity:"quote",dataTableColumns:h})]})})]})]}):null}function Fe(){return e.jsx(ue,{})}export{Fe as default};
